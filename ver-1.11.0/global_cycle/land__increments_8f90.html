<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>global_cycle: /lfs/h2/emc/global/noscrub/George.Gayno/ufs_utils.git/UFS_UTILS/sorc/global_cycle.fd/land_increments.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">global_cycle
   &#160;<span id="projectnumber">1.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('land__increments_8f90.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">land_increments.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines for applyng land DA increments.  
<a href="#details">More...</a></p>

<p><a href="land__increments_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ae260c4c211018b060db3dfb15fdf74d6"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="land__increments_8f90.html#ae260c4c211018b060db3dfb15fdf74d6">land_increments::add_increment_snow</a> (snd_inc, mask, lensfc, snd)</td></tr>
<tr class="memdesc:ae260c4c211018b060db3dfb15fdf74d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add snow depth increment to model snow depth state, and limit output to be non-negative.  <a href="land__increments_8f90.html#ae260c4c211018b060db3dfb15fdf74d6">More...</a><br /></td></tr>
<tr class="separator:ae260c4c211018b060db3dfb15fdf74d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a425ded6741ffff2a673035ac541c8c89"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="land__increments_8f90.html#a425ded6741ffff2a673035ac541c8c89">land_increments::add_increment_soil</a> (rla, rlo, stc_state, smc_state, slc_state, stc_updated, slc_updated, soilsnow_tile, soilsnow_fg_tile, lensfc, lsoil, idim, jdim, lsm, myrank)</td></tr>
<tr class="memdesc:a425ded6741ffff2a673035ac541c8c89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read in gsi file with soil state increments (on the gaussian grid), interpolate increments to the cubed-sphere tile, and add to the soil states.  <a href="land__increments_8f90.html#a425ded6741ffff2a673035ac541c8c89">More...</a><br /></td></tr>
<tr class="separator:a425ded6741ffff2a673035ac541c8c89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46cacafd29fb14ec2945614634e35478"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="land__increments_8f90.html#a46cacafd29fb14ec2945614634e35478">land_increments::apply_land_da_adjustments_snd</a> (lsm, lensfc, mask, swe_bck, snd_bck, snd_anl, swe_adj)</td></tr>
<tr class="memdesc:a46cacafd29fb14ec2945614634e35478"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make adjustments to dependent variables after applying land increments.  <a href="land__increments_8f90.html#a46cacafd29fb14ec2945614634e35478">More...</a><br /></td></tr>
<tr class="separator:a46cacafd29fb14ec2945614634e35478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eb9fa735a3dd4b7757eec092da0317e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="land__increments_8f90.html#a0eb9fa735a3dd4b7757eec092da0317e">land_increments::apply_land_da_adjustments_soil</a> (lsm, isot, ivegsrc, lensfc, lsoil, rsoiltype, mask, stc_bck, stc_adj, smc_adj, slc_adj, stc_updated, slc_updated, zsoil)</td></tr>
<tr class="memdesc:a0eb9fa735a3dd4b7757eec092da0317e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make adjustments to dependent variables after applying land increments.  <a href="land__increments_8f90.html#a0eb9fa735a3dd4b7757eec092da0317e">More...</a><br /></td></tr>
<tr class="separator:a0eb9fa735a3dd4b7757eec092da0317e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af965fc620e3a6d871e762d0adc67f386"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="land__increments_8f90.html#af965fc620e3a6d871e762d0adc67f386">land_increments::calculate_landinc_mask</a> (smc, swe, vtype, lensfc, veg_type_landice, mask)</td></tr>
<tr class="memdesc:af965fc620e3a6d871e762d0adc67f386"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate soil mask for land on model grid.  <a href="land__increments_8f90.html#af965fc620e3a6d871e762d0adc67f386">More...</a><br /></td></tr>
<tr class="separator:af965fc620e3a6d871e762d0adc67f386"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad0e0ffe4348e56494575f7f004452868"><td class="memItemLeft" align="right" valign="top">integer, parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="land__increments_8f90.html#ad0e0ffe4348e56494575f7f004452868">land_increments::lsm_noah</a> =1</td></tr>
<tr class="memdesc:ad0e0ffe4348e56494575f7f004452868"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag for NOAH land surface model  <a href="land__increments_8f90.html#ad0e0ffe4348e56494575f7f004452868">More...</a><br /></td></tr>
<tr class="separator:ad0e0ffe4348e56494575f7f004452868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f83b45e15f8b52c19a9fb3ea1835009"><td class="memItemLeft" align="right" valign="top">integer, parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="land__increments_8f90.html#a3f83b45e15f8b52c19a9fb3ea1835009">land_increments::lsm_noahmp</a> =2</td></tr>
<tr class="memdesc:a3f83b45e15f8b52c19a9fb3ea1835009"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag for NOAHMP land surface model copied from GFS_typedefs.F90  <a href="land__increments_8f90.html#a3f83b45e15f8b52c19a9fb3ea1835009">More...</a><br /></td></tr>
<tr class="separator:a3f83b45e15f8b52c19a9fb3ea1835009"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45e8f8152a7d38fc49808987a86e8cd1"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="land__increments_8f90.html#a45e8f8152a7d38fc49808987a86e8cd1">land_increments::lsoil_incr</a> =3</td></tr>
<tr class="memdesc:a45e8f8152a7d38fc49808987a86e8cd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of layers to add incrments to  <a href="land__increments_8f90.html#a45e8f8152a7d38fc49808987a86e8cd1">More...</a><br /></td></tr>
<tr class="separator:a45e8f8152a7d38fc49808987a86e8cd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a942fd8279c4a90e040fa084be0f92d1f"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="land__increments_8f90.html#a942fd8279c4a90e040fa084be0f92d1f">land_increments::tfreez</a> =273.16</td></tr>
<tr class="memdesc:a942fd8279c4a90e040fa084be0f92d1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">con_t0c in physcons  <a href="land__increments_8f90.html#a942fd8279c4a90e040fa084be0f92d1f">More...</a><br /></td></tr>
<tr class="separator:a942fd8279c4a90e040fa084be0f92d1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines for applyng land DA increments. </p>
<dl class="section author"><dt>Author</dt><dd>Clara Draper ESRL/PSL </dd></dl>

<p class="definition">Definition in file <a class="el" href="land__increments_8f90_source.html">land_increments.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="file_ae260c4c211018b060db3dfb15fdf74d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_ae260c4c211018b060db3dfb15fdf74d6">&#9670;&nbsp;</a></span>add_increment_snow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public land_increments::add_increment_snow </td>
          <td>(</td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>snd_inc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lensfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(inout)&#160;</td>
          <td class="paramname"><em>snd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add snow depth increment to model snow depth state, and limit output to be non-negative. </p>
<p>JEDI increments are calculated globally, so must be screened to land-only locations here.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lensfc</td><td>Number of land points on this tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">snd_inc</td><td>Soil depth increments </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mask</td><td>Land mask for increments </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">snd</td><td>Soil depth background (in), and analysis (out)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Clara Draper. </dd></dl>
<dl class="section date"><dt>Date</dt><dd>August 2021 </dd></dl>

<p class="definition">Definition at line <a class="el" href="land__increments_8f90_source.html#l00379">379</a> of file <a class="el" href="land__increments_8f90_source.html">land_increments.f90</a>.</p>

</div>
</div>
<a id="file_a425ded6741ffff2a673035ac541c8c89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a425ded6741ffff2a673035ac541c8c89">&#9670;&nbsp;</a></span>add_increment_soil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public land_increments::add_increment_soil </td>
          <td>(</td>
          <td class="paramtype">real, dimension(lensfc), intent(inout)&#160;</td>
          <td class="paramname"><em>rla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(inout)&#160;</td>
          <td class="paramname"><em>rlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc, lsoil), intent(inout)&#160;</td>
          <td class="paramname"><em>stc_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc, lsoil), intent(inout)&#160;</td>
          <td class="paramname"><em>smc_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc, lsoil), intent(inout)&#160;</td>
          <td class="paramname"><em>slc_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lensfc), intent(out)&#160;</td>
          <td class="paramname"><em>stc_updated</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lensfc), intent(out)&#160;</td>
          <td class="paramname"><em>slc_updated</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>soilsnow_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>soilsnow_fg_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lensfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsoil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>idim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>myrank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read in gsi file with soil state increments (on the gaussian grid), interpolate increments to the cubed-sphere tile, and add to the soil states. </p>
<p>Adapted from adjust_nsst. Currently only coded for soil temperature. Soil moisture will need the model soil moisture paramaters for regridding.</p>
<p>Does not make a temperature update if snow differ between fg and anal (allow correction of snow to address temperature error first), or if snow is present (will eventually updating of snow temperature in this case)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">RLA</td><td>Latitude on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">RLO</td><td>Longitude on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">STC_STATE</td><td>Soil temperature state vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">SMC_STATE</td><td>Soil moisture (liquid plus solid) state vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">SLC_STATE</td><td>Liquid soil moisture state vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stc_updated</td><td>Integer to record whether STC in each grid cell was updated </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">slc_updated</td><td>Integer to record whether SMC in each grid cell was updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SOILSNOW_TILE</td><td>Land mask for increments on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SOILSNOW_FG_TILE</td><td>First guess land mask for increments on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LENSFC</td><td>Number of land points on a tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LSOIL</td><td>Number of soil layers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IDIM</td><td>'I' dimension of a tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">JDIM</td><td>'J' dimension of a tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lsm</td><td>Integer flag indicating which land model is used (1-Noah, 2-Noah-MP) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MYRANK</td><td>MPI rank number</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Clara Draper. </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 2021 </dd></dl>

<p class="definition">Definition at line <a class="el" href="land__increments_8f90_source.html#l00057">57</a> of file <a class="el" href="land__increments_8f90_source.html">land_increments.f90</a>.</p>

</div>
</div>
<a id="file_a46cacafd29fb14ec2945614634e35478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a46cacafd29fb14ec2945614634e35478">&#9670;&nbsp;</a></span>apply_land_da_adjustments_snd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public land_increments::apply_land_da_adjustments_snd </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lensfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>swe_bck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>snd_bck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>snd_anl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(inout)&#160;</td>
          <td class="paramname"><em>swe_adj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make adjustments to dependent variables after applying land increments. </p>
<p>These adjustments are model-dependent, and are currently only coded for Noah LSM. Here: adjust SWE to be consistent with updated SND, using snow density from the forecast. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lsm</td><td>Integer code for the LSM </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lensfc</td><td>Number of land points for this tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mask</td><td>Land mask for increments </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">swe_bck</td><td>Background SWE </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">snd_bck</td><td>Background snow depth </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">snd_anl</td><td>Analysis snow depth </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">swe_adj</td><td>SWE to be adjusted </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Clara Draper </dd></dl>
<dl class="section date"><dt>Date</dt><dd>August 2021 </dd></dl>

<p class="definition">Definition at line <a class="el" href="land__increments_8f90_source.html#l00627">627</a> of file <a class="el" href="land__increments_8f90_source.html">land_increments.f90</a>.</p>

</div>
</div>
<a id="file_a0eb9fa735a3dd4b7757eec092da0317e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a0eb9fa735a3dd4b7757eec092da0317e">&#9670;&nbsp;</a></span>apply_land_da_adjustments_soil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public land_increments::apply_land_da_adjustments_soil </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ivegsrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lensfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsoil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>rsoiltype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc, lsoil), intent(in)&#160;</td>
          <td class="paramname"><em>stc_bck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc, lsoil), intent(inout)&#160;</td>
          <td class="paramname"><em>stc_adj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc,lsoil), intent(inout)&#160;</td>
          <td class="paramname"><em>smc_adj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc,lsoil), intent(inout)&#160;</td>
          <td class="paramname"><em>slc_adj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>stc_updated</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>slc_updated</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), dimension(lsoil), intent(in)&#160;</td>
          <td class="paramname"><em>zsoil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make adjustments to dependent variables after applying land increments. </p>
<p>These adjustments are model-dependent, and are currently only coded if full for Noah LSM. For Noah LSM, copy relevent code blocks from model code (same as has been done in sfc_sub). For Noah-MP, have inserted place-holders to simply reset the model <br />
 variables back to the analysis if adjustments are needed. Later, will replace this with appropriate adjustmenets (in summary, for now we do not make STC updates if soils are frozen, and are also not applying the appropriate max. values for SMC). Here: adjust (frozen) soil moisture to be consistent with changes in soil temperature from DA </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lsm</td><td>Integer code for the LSM </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isot</td><td>Integer code for the soil type data set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ivegsrc</td><td>Integer code for the vegetation type data set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lensfc</td><td>Number of land points for this tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lsoil</td><td>Number of soil layers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rsoiltype</td><td>Array of input soil types </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mask</td><td>Mask indicating surface type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stc_bck</td><td>Background soil temperature states </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stc_adj</td><td>Analysis soil temperature states </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">smc_adj</td><td>Analysis soil moisture states </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">slc_adj</td><td>Analysis liquid soil moisture states </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stc_updated</td><td>Integer to record whether STC in each grid cell was updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slc_updated</td><td>Integer to record whether SLC in each grid cell was updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zsoil</td><td>Depth of bottom of each soil layer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Clara Draper </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April 2021 </dd></dl>

<p class="definition">Definition at line <a class="el" href="land__increments_8f90_source.html#l00468">468</a> of file <a class="el" href="land__increments_8f90_source.html">land_increments.f90</a>.</p>

</div>
</div>
<a id="file_af965fc620e3a6d871e762d0adc67f386"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_af965fc620e3a6d871e762d0adc67f386">&#9670;&nbsp;</a></span>calculate_landinc_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public land_increments::calculate_landinc_mask </td>
          <td>(</td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>smc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>swe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>vtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lensfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>veg_type_landice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lensfc), intent(out)&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate soil mask for land on model grid. </p>
<p>Output is 1 - soil, 2 - snow-covered, 0 - land ice, -1 not land.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lensfc</td><td>Number of land points for this tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">veg_type_landice</td><td>Value of vegetion class that indicates land-ice </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">smc</td><td>Model soil moisture. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">swe</td><td>Model snow water equivalent </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vtype</td><td>Model vegetation type </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mask</td><td>Land mask for increments </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Clara Draper </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 2021 </dd></dl>

<p class="definition">Definition at line <a class="el" href="land__increments_8f90_source.html#l00409">409</a> of file <a class="el" href="land__increments_8f90_source.html">land_increments.f90</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="file_ad0e0ffe4348e56494575f7f004452868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_ad0e0ffe4348e56494575f7f004452868">&#9670;&nbsp;</a></span>lsm_noah</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter, public land_increments::lsm_noah =1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>flag for NOAH land surface model </p>

<p class="definition">Definition at line <a class="el" href="land__increments_8f90_source.html#l00016">16</a> of file <a class="el" href="land__increments_8f90_source.html">land_increments.f90</a>.</p>

</div>
</div>
<a id="file_a3f83b45e15f8b52c19a9fb3ea1835009"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a3f83b45e15f8b52c19a9fb3ea1835009">&#9670;&nbsp;</a></span>lsm_noahmp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter, public land_increments::lsm_noahmp =2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>flag for NOAHMP land surface model copied from GFS_typedefs.F90 </p>

<p class="definition">Definition at line <a class="el" href="land__increments_8f90_source.html#l00017">17</a> of file <a class="el" href="land__increments_8f90_source.html">land_increments.f90</a>.</p>

</div>
</div>
<a id="file_a45e8f8152a7d38fc49808987a86e8cd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a45e8f8152a7d38fc49808987a86e8cd1">&#9670;&nbsp;</a></span>lsoil_incr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter land_increments::lsoil_incr =3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>number of layers to add incrments to </p>

<p class="definition">Definition at line <a class="el" href="land__increments_8f90_source.html#l00021">21</a> of file <a class="el" href="land__increments_8f90_source.html">land_increments.f90</a>.</p>

</div>
</div>
<a id="file_a942fd8279c4a90e040fa084be0f92d1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a942fd8279c4a90e040fa084be0f92d1f">&#9670;&nbsp;</a></span>tfreez</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter land_increments::tfreez =273.16</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>con_t0c in physcons </p>

<p class="definition">Definition at line <a class="el" href="land__increments_8f90_source.html#l00023">23</a> of file <a class="el" href="land__increments_8f90_source.html">land_increments.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d8b772108138bf796aaa3f7fe4e09294.html">sorc</a></li><li class="navelem"><a class="el" href="dir_2639f2b978b79eb67637490d5ddd2bd6.html">global_cycle.fd</a></li><li class="navelem"><a class="el" href="land__increments_8f90.html">land_increments.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
