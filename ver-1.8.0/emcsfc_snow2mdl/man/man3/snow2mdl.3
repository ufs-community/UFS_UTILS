.TH "snow2mdl" 3 "Thu Aug 4 2022" "Version 1.8.0" "emcsfc_snow2mdl" \" -*- nroff -*-
.ad l
.nh
.SH NAME
snow2mdl \- Interpolate snow data to model grid and grib the result\&.  

.SH SYNOPSIS
.br
.PP
.SS "Functions/Subroutines"

.in +1c
.ti -1c
.RI "subroutine, public \fBinterp\fP"
.br
.RI "Interpolate snow data to model grid\&. "
.ti -1c
.RI "subroutine \fBintlon\fP (iord, imon, imsk, m1, m2, k1, f1, f2)"
.br
.RI "Convert data from the thinned (or reduced) to the full grid along a single row\&. "
.ti -1c
.RI "subroutine \fBuninterpred\fP (iord, kmsk, fi, f, lonl, latd, len, lonsperlat)"
.br
.RI "Fills out full grid using thinned grid data\&. "
.ti -1c
.RI "subroutine \fBwrite_grib1\fP"
.br
.RI "Write grib1 snow cover and depth on the model grid\&. "
.ti -1c
.RI "subroutine \fBwrite_grib2\fP"
.br
.RI "Write grib2 snow cover and depth on the model grid\&. "
.in -1c
.SS "Variables"

.in +1c
.ti -1c
.RI "real, dimension(:,:), allocatable \fBsnow_cvr_mdl\fP"
.br
.RI "snow cover on model grid in percent "
.ti -1c
.RI "real, dimension(:,:), allocatable \fBsnow_dep_mdl\fP"
.br
.RI "snow depth on model grid in meters "
.in -1c
.SH "Detailed Description"
.PP 
Interpolate snow data to model grid and grib the result\&. 

program history log:
.IP "\(bu" 2
2005-Dec-16 gayno - initial version
.IP "\(bu" 2
2007-Sep-20 gayno - Tested for b-grids\&. Added improved thinning for gfs grid\&.
.IP "\(bu" 2
2008-Feb-04 gayno - Added autosnow data\&.
.IP "\(bu" 2
2014-Sep-26 gayno - Added option to output analysed snow in grib2\&.
.PP
.PP
variable definitions:
.IP "\(bu" 2
snow_cvr_mdl -
.IP "\(bu" 2
snow_dep_mdl -
.PP
.PP
\fBAuthor:\fP
.RS 4
George Gayno org: w/np2 
.RE
.PP
\fBDate:\fP
.RS 4
2005-Dec-16 
.RE
.PP

.SH "Function/Subroutine Documentation"
.PP 
.SS "subroutine, public snow2mdl::interp ()"

.PP
Interpolate snow data to model grid\&. program history log: 2005-dec-16 gayno - initial version 2007-sep-20 gayno - tested for b-grids\&. added improved thinning for gfs grid\&. 2008-feb-04 gayno - add use of autosnow data 2014-sep-29 gayno - add option to output model snow data in grib2 format\&.
.PP
condition codes: all fatal 54 - selected input snow data not valid for model grid 55 - error in ipolates interpolating snow data
.PP
\fBNote:\fP
.RS 4
The determination of cover and depth on the model grid depends on the input snow data selected\&.
.RE
.PP
nam grids:
.PP
1) nesdis/ims only - An analysis of snow cover on the model grid is produced\&. No depth analysis is produced\&.
.PP
2) afwa only - An analysis of snow cover and depth on the model grid is produced\&. Depth is determined from the afwa data\&. Cover is set to 100% where afwa indicates snow and 0% otherwise\&.
.PP
3) nesdis/ims and afwa - An analysis of snow cover and depth on the model grid is produced\&. Cover is determined by the nesdis/ims data\&. If cover is greater than user-defined threshold (variable snow_cvr_threshold) the depth is set to the afwa value or a nominal value, whichever is greater\&. The nominal value is user-defined (varaible min_snow_depth)\&. If cover is less than user- defined threshold, the depth is set to 0, regardless of the afwa depth value\&.
.PP
gfs grid:
.PP
1) nesdis/ims and autosnow only - An analysis of snow cover and depth on the model grid is produced\&. Cover is determined from the ims and autosnow data\&. If cover is greater than the user-defined threshold (variable snow_cvr_threshold), the the depth is set to the user-defined default depth (variable min_snow_depth)\&.
.PP
2) afwa only - An analysis of snow cover and depth on the model grid is produced\&. Depth is determined from the afwa data\&. Cover is set to 100% where afwa indicates snow and 0% otherwise\&.
.PP
3) nesdis/ims, autosnow and afwa - An analysis of snow cover and depth on the model grid is produced\&. Cover is determined by the ims and autosnow data\&. If cover is greater than user-defined threshold (variable snow_cvr_threshold) the depth is set to the afwa value or a nominal value, whichever is greater\&. The nominal value is user-defined (varaible min_snow_depth)\&. If cover is less than user- defined threshold, the depth is set to 0, regardless of the afwa depth value\&.
.PP
\fBAuthor:\fP
.RS 4
George Gayno org: w/np2 
.RE
.PP
\fBDate:\fP
.RS 4
2005-Dec-16 
.RE
.PP

.PP
Definition at line 158 of file snow2mdl\&.F90\&.
.PP
References snowdat::afwa_res, snowdat::autosnow_res, snowdat::bitmap_afwa_global, snowdat::bitmap_afwa_nh, snowdat::bitmap_afwa_sh, snowdat::bitmap_autosnow, snowdat::bitmap_nesdis, snowdat::iafwa, snowdat::iautosnow, model_grid::ijmdl, model_grid::imdl, snowdat::inesdis, model_grid::ipts_mdl, snowdat::jafwa, snowdat::jautosnow, model_grid::jmdl, snowdat::jnesdis, model_grid::jpts_mdl, snowdat::kgds_afwa_global, snowdat::kgds_afwa_nh, snowdat::kgds_afwa_sh, snowdat::kgds_autosnow, model_grid::kgds_mdl, snowdat::kgds_nesdis, program_setup::lat_threshold, model_grid::lats_mdl, model_grid::lons_mdl, model_grid::lonsperlat_mdl, model_grid::lsmask_mdl, model_grid::lsmask_mdl_sav, program_setup::min_snow_depth, snowdat::nesdis_res, program_setup::output_grib2, model_grid::resol_mdl, snowdat::sea_ice_nesdis, snowdat::snow_cvr_autosnow, snow_cvr_mdl, snowdat::snow_cvr_nesdis, program_setup::snow_cvr_threshold, snowdat::snow_dep_afwa_global, snowdat::snow_dep_afwa_nh, snowdat::snow_dep_afwa_sh, snow_dep_mdl, model_grid::thinned, uninterpred(), snowdat::use_autosnow, snowdat::use_global_afwa, snowdat::use_nesdis, snowdat::use_nh_afwa, snowdat::use_sh_afwa, write_grib1(), and write_grib2()\&.
.PP
Referenced by driver()\&.
.SS "subroutine snow2mdl::intlon (integer, intent(in) iord, integer, intent(in) imon, integer, intent(in) imsk, integer, intent(in) m1, integer, intent(in) m2, integer, dimension(m1), intent(in) k1, real, dimension(m1), intent(in) f1, real, dimension(m2), intent(out) f2)\fC [private]\fP"

.PP
Convert data from the thinned (or reduced) to the full grid along a single row\&. 
.PP
\fBParameters:\fP
.RS 4
\fIiord\fP Interpolation method\&. '1' neighbor; '2' bilinear\&. 
.br
\fIimon\fP Not used\&. 
.br
\fIimsk\fP Flag to account for mask during conversion\&. '0' - use mask\&. 
.br
\fIm1\fP Number of points along a row of the thinned grid\&. 
.br
\fIm2\fP Number of points along a row on the full grid\&. 
.br
\fIk1\fP Mask of input data\&. 
.br
\fIf1\fP Data on the thinned (or reduced) grid\&. 
.br
\fIf2\fP Data on the full grid\&.
.RE
.PP
\fBAuthor:\fP
.RS 4
George Gayno org: w/np2 
.RE
.PP
\fBDate:\fP
.RS 4
2005-Dec-16 
.RE
.PP

.PP
Definition at line 1152 of file snow2mdl\&.F90\&.
.PP
Referenced by uninterpred()\&.
.SS "subroutine snow2mdl::uninterpred (integer, intent(in) iord, integer, dimension(lonl*latd), intent(in) kmsk, real, dimension(len), intent(in) fi, real, dimension(lonl,latd), intent(out) f, integer, intent(in) lonl, integer, intent(in) latd, integer, intent(in) len, integer, dimension(latd/2), intent(in) lonsperlat)\fC [private]\fP"

.PP
Fills out full grid using thinned grid data\&. Use an iord of '1' to use a nearest neighbor approach\&.
.PP
\fBParameters:\fP
.RS 4
\fIiord\fP Interpolation method\&. '1' neighbor; '2' bilinear\&. 
.br
\fIkmsk\fP Mask of the input data\&. For masked fields, set to '1' for defined points, '0' for undefined points\&. Not used for unmasked fields - set to '0'\&. 
.br
\fIfi\fP 1-d array to be processed\&. 
.br
\fIf\fP 2-d array on the full grid\&. 
.br
\fIlonl\fP 'i' dimension of 2-d data\&. 
.br
\fIlatd\fP 'j' dimension of 2-d data\&. 
.br
\fIlen\fP Number of elements of 1-d data\&. 
.br
\fIlonsperlat\fP Definition of thinned (or reduced) grid\&. Number of 'i' points for each 'j' row\&.
.RE
.PP
\fBAuthor:\fP
.RS 4
George Gayno org: w/np2 
.RE
.PP
\fBDate:\fP
.RS 4
2005-Dec-16 
.RE
.PP

.PP
Definition at line 1101 of file snow2mdl\&.F90\&.
.PP
References intlon()\&.
.PP
Referenced by interp()\&.
.SS "subroutine snow2mdl::write_grib1 ()"

.PP
Write grib1 snow cover and depth on the model grid\&. program history log: 2005-dec-16 gayno - Initial version 2014-sep-26 gayno - Rename as write_grib1 (was gribit)\&.
.PP
output file:
.IP "\(bu" 2
snow on model grid, grib 1, unit=lugb
.PP
.PP
condition codes:
.IP "\(bu" 2
57 - error writing model snow depth record
.IP "\(bu" 2
58 - error writing model snow cover record
.IP "\(bu" 2
59 - error opening model snow file
.PP
.PP
\fBAuthor:\fP
.RS 4
George Gayno org: w/np2 
.RE
.PP
\fBDate:\fP
.RS 4
2005-Dec-16 
.RE
.PP

.PP
Definition at line 989 of file snow2mdl\&.F90\&.
.PP
References program_setup::grib_century, program_setup::grib_day, program_setup::grib_hour, program_setup::grib_month, program_setup::grib_year, model_grid::grid_id_mdl, model_grid::kgds_mdl, model_grid::lsmask_mdl, program_setup::model_snow_file, snow_cvr_mdl, snow_dep_mdl, snowdat::use_global_afwa, snowdat::use_nh_afwa, and snowdat::use_sh_afwa\&.
.PP
Referenced by interp()\&.
.SS "subroutine snow2mdl::write_grib2 ()"

.PP
Write grib2 snow cover and depth on the model grid\&. program history log: 2014-sep-26 gayno - initial version
.PP
output file:
.IP "\(bu" 2
snow on the model grid, grib 2, unit=lugb
.PP
.PP
condition codes: all fatal
.IP "\(bu" 2
48 error writing model snow flie
.IP "\(bu" 2
49 error opening model snow flie
.PP
.PP
\fBAuthor:\fP
.RS 4
George Gayno org: w/np2 
.RE
.PP
\fBDate:\fP
.RS 4
2014-Sep-26 
.RE
.PP

.PP
Definition at line 809 of file snow2mdl\&.F90\&.
.PP
References grib2_check(), program_setup::grib_century, program_setup::grib_day, program_setup::grib_hour, program_setup::grib_month, program_setup::grib_year, model_grid::imdl, init_grib2(), model_grid::jmdl, model_grid::kgds_mdl, model_grid::lat11, model_grid::latlast, model_grid::lon11, model_grid::lonlast, model_grid::lsmask_mdl, program_setup::model_snow_file, snow_cvr_mdl, snow_dep_mdl, snowdat::use_global_afwa, snowdat::use_nh_afwa, and snowdat::use_sh_afwa\&.
.PP
Referenced by interp()\&.
.SH "Variable Documentation"
.PP 
.SS "real, dimension(:,:), allocatable snow2mdl::snow_cvr_mdl\fC [private]\fP"

.PP
snow cover on model grid in percent 
.PP
Definition at line 85 of file snow2mdl\&.F90\&.
.PP
Referenced by interp(), write_grib1(), and write_grib2()\&.
.SS "real, dimension(:,:), allocatable snow2mdl::snow_dep_mdl\fC [private]\fP"

.PP
snow depth on model grid in meters 
.PP
Definition at line 86 of file snow2mdl\&.F90\&.
.PP
Referenced by interp(), write_grib1(), and write_grib2()\&.
.SH "Author"
.PP 
Generated automatically by Doxygen for emcsfc_snow2mdl from the source code\&.
