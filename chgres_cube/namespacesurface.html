<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>chgres_cube: surface Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">chgres_cube
   &#160;<span id="projectnumber">1.13.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacesurface.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">surface Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Process surface and nst fields.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsurface_1_1realptr__2d.html">realptr_2d</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsurface_1_1realptr__3d.html">realptr_3d</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ae4bf53bef0b16e89d6344df2b6aa1888"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#ae4bf53bef0b16e89d6344df2b6aa1888">adjust_soil_levels</a> (localpet)</td></tr>
<tr class="memdesc:ae4bf53bef0b16e89d6344df2b6aa1888"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjust soil levels of the input grid if there is a mismatch between input and target grids.  <a href="#ae4bf53bef0b16e89d6344df2b6aa1888">More...</a><br /></td></tr>
<tr class="separator:ae4bf53bef0b16e89d6344df2b6aa1888"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7592ccae34fbacf04fe5f69ffac4aeb6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a7592ccae34fbacf04fe5f69ffac4aeb6">adjust_soilt_for_terrain</a></td></tr>
<tr class="memdesc:a7592ccae34fbacf04fe5f69ffac4aeb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjust soil temperature for changes in terrain height between the input and target grids.  <a href="#a7592ccae34fbacf04fe5f69ffac4aeb6">More...</a><br /></td></tr>
<tr class="separator:a7592ccae34fbacf04fe5f69ffac4aeb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5e2bc59e4d2fa0c063c0dff2d059111"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#ac5e2bc59e4d2fa0c063c0dff2d059111">calc_liq_soil_moisture</a></td></tr>
<tr class="memdesc:ac5e2bc59e4d2fa0c063c0dff2d059111"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute liquid portion of the total soil moisture.  <a href="#ac5e2bc59e4d2fa0c063c0dff2d059111">More...</a><br /></td></tr>
<tr class="separator:ac5e2bc59e4d2fa0c063c0dff2d059111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d2198fe7684f6f0da6f35863f90e931"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a7d2198fe7684f6f0da6f35863f90e931">cleanup_all_target_sfc_data</a></td></tr>
<tr class="memdesc:a7d2198fe7684f6f0da6f35863f90e931"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free up memory once the target grid surface fields are no longer needed.  <a href="#a7d2198fe7684f6f0da6f35863f90e931">More...</a><br /></td></tr>
<tr class="separator:a7d2198fe7684f6f0da6f35863f90e931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0072f75a8c94bd12bc0e84d392cec723"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a0072f75a8c94bd12bc0e84d392cec723">create_nst_esmf_fields</a></td></tr>
<tr class="memdesc:a0072f75a8c94bd12bc0e84d392cec723"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create ESMF fields for the target grid nst variables.  <a href="#a0072f75a8c94bd12bc0e84d392cec723">More...</a><br /></td></tr>
<tr class="separator:a0072f75a8c94bd12bc0e84d392cec723"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eeed6bc8807704d095c5356d5026518"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a0eeed6bc8807704d095c5356d5026518">create_surface_esmf_fields</a></td></tr>
<tr class="memdesc:a0eeed6bc8807704d095c5356d5026518"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create ESMF fields for the target grid surface variables.  <a href="#a0eeed6bc8807704d095c5356d5026518">More...</a><br /></td></tr>
<tr class="separator:a0eeed6bc8807704d095c5356d5026518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28f896df0eb043882b4758dfc9ae1aae"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a28f896df0eb043882b4758dfc9ae1aae">frh2o</a> (TKELV, SMC, SH2O, SMCMAX, BEXP, PSIS)</td></tr>
<tr class="memdesc:a28f896df0eb043882b4758dfc9ae1aae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate supercooled soil moisture.  <a href="#a28f896df0eb043882b4758dfc9ae1aae">More...</a><br /></td></tr>
<tr class="separator:a28f896df0eb043882b4758dfc9ae1aae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a2257539e521c7e72bd2b3c76f72044"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a7a2257539e521c7e72bd2b3c76f72044">ij_to_i_j</a> (ij, itile, jtile, i, j)</td></tr>
<tr class="memdesc:a7a2257539e521c7e72bd2b3c76f72044"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert 1d index to 2d indices.  <a href="#a7a2257539e521c7e72bd2b3c76f72044">More...</a><br /></td></tr>
<tr class="separator:a7a2257539e521c7e72bd2b3c76f72044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8b708efb5c1abfda4a2efc48bef83dd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#ae8b708efb5c1abfda4a2efc48bef83dd">interp</a> (localpet)</td></tr>
<tr class="memdesc:ae8b708efb5c1abfda4a2efc48bef83dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Horizontally interpolate surface fields from input to target FV3 grid using esmf routines.  <a href="#ae8b708efb5c1abfda4a2efc48bef83dd">More...</a><br /></td></tr>
<tr class="separator:ae8b708efb5c1abfda4a2efc48bef83dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37509f4fa66fcf75ee97f82cb99927b9"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a37509f4fa66fcf75ee97f82cb99927b9">nst_land_fill</a></td></tr>
<tr class="memdesc:a37509f4fa66fcf75ee97f82cb99927b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">nst is not active at land or sea ice points.  <a href="#a37509f4fa66fcf75ee97f82cb99927b9">More...</a><br /></td></tr>
<tr class="separator:a37509f4fa66fcf75ee97f82cb99927b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a232ef616dae3429cdd609b34ed59dcb1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a232ef616dae3429cdd609b34ed59dcb1">qc_check</a></td></tr>
<tr class="memdesc:a232ef616dae3429cdd609b34ed59dcb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform some quality control checks and set flag values at non-active points.  <a href="#a232ef616dae3429cdd609b34ed59dcb1">More...</a><br /></td></tr>
<tr class="separator:a232ef616dae3429cdd609b34ed59dcb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c687bf7da96c3c512b13a6a7eab4b99"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a5c687bf7da96c3c512b13a6a7eab4b99">regrid_many</a> (bundle_pre, bundle_post, num_field, route, dozero, unmapped_ptr, resetifd)</td></tr>
<tr class="memdesc:a5c687bf7da96c3c512b13a6a7eab4b99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regrid multiple ESMF fields from input to target grid.  <a href="#a5c687bf7da96c3c512b13a6a7eab4b99">More...</a><br /></td></tr>
<tr class="separator:a5c687bf7da96c3c512b13a6a7eab4b99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63fb2a0ed00bdec5e4f0b3360a5709a6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a63fb2a0ed00bdec5e4f0b3360a5709a6">rescale_soil_moisture</a></td></tr>
<tr class="memdesc:a63fb2a0ed00bdec5e4f0b3360a5709a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjust soil moisture for changes in soil type between the input and target grids.  <a href="#a63fb2a0ed00bdec5e4f0b3360a5709a6">More...</a><br /></td></tr>
<tr class="separator:a63fb2a0ed00bdec5e4f0b3360a5709a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab18f8cebd46379b7b81a69829326eed0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#ab18f8cebd46379b7b81a69829326eed0">roughness</a></td></tr>
<tr class="memdesc:ab18f8cebd46379b7b81a69829326eed0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set roughness length at points with some sea ice to 1 cm.  <a href="#ab18f8cebd46379b7b81a69829326eed0">More...</a><br /></td></tr>
<tr class="separator:ab18f8cebd46379b7b81a69829326eed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc2c63e91ef5af4cefca13d9673d4acc"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#afc2c63e91ef5af4cefca13d9673d4acc">search_many</a> (num_field, bundle_target, tile, search_nums, localpet, latitude, terrain_land, soilt_climo, mask)</td></tr>
<tr class="memdesc:afc2c63e91ef5af4cefca13d9673d4acc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the search function for multple fields.  <a href="#afc2c63e91ef5af4cefca13d9673d4acc">More...</a><br /></td></tr>
<tr class="separator:afc2c63e91ef5af4cefca13d9673d4acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0707121ff6af9350608125b1750e32f5"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a0707121ff6af9350608125b1750e32f5">surface_driver</a> (localpet)</td></tr>
<tr class="memdesc:a0707121ff6af9350608125b1750e32f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver routine to process surface/nst data.  <a href="#a0707121ff6af9350608125b1750e32f5">More...</a><br /></td></tr>
<tr class="separator:a0707121ff6af9350608125b1750e32f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48b3ef0181a25662f39eca384b3c1194"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a48b3ef0181a25662f39eca384b3c1194">update_landmask</a></td></tr>
<tr class="memdesc:a48b3ef0181a25662f39eca384b3c1194"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update landmask for sea ice.  <a href="#a48b3ef0181a25662f39eca384b3c1194">More...</a><br /></td></tr>
<tr class="separator:a48b3ef0181a25662f39eca384b3c1194"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8504e69c586b0d22fd77f08056996bec"><td class="memItemLeft" align="right" valign="top">real, parameter, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a8504e69c586b0d22fd77f08056996bec">blim</a> = 5.5</td></tr>
<tr class="memdesc:a8504e69c586b0d22fd77f08056996bec"><td class="mdescLeft">&#160;</td><td class="mdescRight">soil 'b' parameter limit  <a href="#a8504e69c586b0d22fd77f08056996bec">More...</a><br /></td></tr>
<tr class="separator:a8504e69c586b0d22fd77f08056996bec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38ac050f3afcffb171ecaca67f4338c6"><td class="memItemLeft" align="right" valign="top">real, parameter, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a38ac050f3afcffb171ecaca67f4338c6">frz_h2o</a> = 273.15</td></tr>
<tr class="memdesc:a38ac050f3afcffb171ecaca67f4338c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">melting pt water  <a href="#a38ac050f3afcffb171ecaca67f4338c6">More...</a><br /></td></tr>
<tr class="separator:a38ac050f3afcffb171ecaca67f4338c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c9df7d4a32c856503c625212b2f2fe4"><td class="memItemLeft" align="right" valign="top">real, parameter, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a8c9df7d4a32c856503c625212b2f2fe4">frz_ice</a> = 271.21</td></tr>
<tr class="memdesc:a8c9df7d4a32c856503c625212b2f2fe4"><td class="mdescLeft">&#160;</td><td class="mdescRight">melting pt sea ice  <a href="#a8c9df7d4a32c856503c625212b2f2fe4">More...</a><br /></td></tr>
<tr class="separator:a8c9df7d4a32c856503c625212b2f2fe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d020b9469b9e3dd472fa76b0c4ded06"><td class="memItemLeft" align="right" valign="top">real, parameter, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a0d020b9469b9e3dd472fa76b0c4ded06">grav</a> = 9.81</td></tr>
<tr class="memdesc:a0d020b9469b9e3dd472fa76b0c4ded06"><td class="mdescLeft">&#160;</td><td class="mdescRight">gravity  <a href="#a0d020b9469b9e3dd472fa76b0c4ded06">More...</a><br /></td></tr>
<tr class="separator:a0d020b9469b9e3dd472fa76b0c4ded06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4df26877e3d05576cc7cd54ec22c204"><td class="memItemLeft" align="right" valign="top">real, parameter, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#af4df26877e3d05576cc7cd54ec22c204">hlice</a> = 3.335E5</td></tr>
<tr class="memdesc:af4df26877e3d05576cc7cd54ec22c204"><td class="mdescLeft">&#160;</td><td class="mdescRight">latent heat of fusion  <a href="#af4df26877e3d05576cc7cd54ec22c204">More...</a><br /></td></tr>
<tr class="separator:af4df26877e3d05576cc7cd54ec22c204"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1c448e5b9b098f82e00ea37a3d083f4"><td class="memItemLeft" align="right" valign="top">real(esmf_kind_r8), parameter, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#ad1c448e5b9b098f82e00ea37a3d083f4">missing</a> = -1.e20_esmf_kind_r8</td></tr>
<tr class="memdesc:ad1c448e5b9b098f82e00ea37a3d083f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag for non-active points.  <a href="#ad1c448e5b9b098f82e00ea37a3d083f4">More...</a><br /></td></tr>
<tr class="separator:ad1c448e5b9b098f82e00ea37a3d083f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2150daf83b917a49662ed6473e8e5097"><td class="memItemLeft" align="right" valign="top">type(esmf_field)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a2150daf83b917a49662ed6473e8e5097">soil_type_from_input_grid</a></td></tr>
<tr class="memdesc:a2150daf83b917a49662ed6473e8e5097"><td class="mdescLeft">&#160;</td><td class="mdescRight">soil type interpolated from input grid  <a href="#a2150daf83b917a49662ed6473e8e5097">More...</a><br /></td></tr>
<tr class="separator:a2150daf83b917a49662ed6473e8e5097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab770243d8fd686d14b4eaec335eb7b15"><td class="memItemLeft" align="right" valign="top">type(esmf_field)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#ab770243d8fd686d14b4eaec335eb7b15">terrain_from_input_grid</a></td></tr>
<tr class="memdesc:ab770243d8fd686d14b4eaec335eb7b15"><td class="mdescLeft">&#160;</td><td class="mdescRight">terrain height interpolated from input grid  <a href="#ab770243d8fd686d14b4eaec335eb7b15">More...</a><br /></td></tr>
<tr class="separator:ab770243d8fd686d14b4eaec335eb7b15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dde2acec84877a91162b4bcf795373e"><td class="memItemLeft" align="right" valign="top">type(esmf_field)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a6dde2acec84877a91162b4bcf795373e">terrain_from_input_grid_land</a></td></tr>
<tr class="memdesc:a6dde2acec84877a91162b4bcf795373e"><td class="mdescLeft">&#160;</td><td class="mdescRight">terrain height interpolated from input grid at all land points  <a href="#a6dde2acec84877a91162b4bcf795373e">More...</a><br /></td></tr>
<tr class="separator:a6dde2acec84877a91162b4bcf795373e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aedcff2da595ef7aac69152edbdfa64"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesurface.html#a7aedcff2da595ef7aac69152edbdfa64">veg_type_landice_target</a> = 15</td></tr>
<tr class="memdesc:a7aedcff2da595ef7aac69152edbdfa64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vegetation type category that defines permanent land ice points.  <a href="#a7aedcff2da595ef7aac69152edbdfa64">More...</a><br /></td></tr>
<tr class="separator:a7aedcff2da595ef7aac69152edbdfa64"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Process surface and nst fields. </p>
<p>Interpolates fields from the input to target grids. Adjusts soil temperature according to differences in input and target grid terrain. Rescales soil moisture for soil type differences between input and target grid. Computes frozen portion of total soil moisture.</p>
<p>Assumes the input land data are Noah LSM-based, and the fv3 run will use the Noah LSM. NSST fields are not available when using GRIB2 input data.</p>
<p>Public variables are defined below. "target" indicates field associated with the target grid. "input" indicates field associated with the input grid.</p>
<dl class="section author"><dt>Author</dt><dd>George Gayno NCEP/EMC </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae4bf53bef0b16e89d6344df2b6aa1888"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4bf53bef0b16e89d6344df2b6aa1888">&#9670;&nbsp;</a></span>adjust_soil_levels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine surface::adjust_soil_levels </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>localpet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjust soil levels of the input grid if there is a mismatch between input and target grids. </p>
<p>Presently can only convert from 9 to 4 levels.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">localpet</td><td>ESMF local persistent execution thread </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Larissa Reames </dd>
<dd>
Jeff Beck </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l02047">2047</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="model__grid_8F90_source.html#l00027">model_grid::i_input</a>, <a class="el" href="model__grid_8F90_source.html#l00052">model_grid::input_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00030">model_grid::j_input</a>, and <a class="el" href="model__grid_8F90_source.html#l00025">model_grid::lsoil_target</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="a7592ccae34fbacf04fe5f69ffac4aeb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7592ccae34fbacf04fe5f69ffac4aeb6">&#9670;&nbsp;</a></span>adjust_soilt_for_terrain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine surface::adjust_soilt_for_terrain </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjust soil temperature for changes in terrain height between the input and target grids. </p>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l01971">1971</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="model__grid_8F90_source.html#l00073">model_grid::landmask_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00051">surface_target_data::soil_temp_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00066">terrain_from_input_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00097">model_grid::terrain_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00057">veg_type_landice_target</a>, and <a class="el" href="static__data_8F90_source.html#l00036">static_data::veg_type_target_grid</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="ac5e2bc59e4d2fa0c063c0dff2d059111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5e2bc59e4d2fa0c063c0dff2d059111">&#9670;&nbsp;</a></span>calc_liq_soil_moisture()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine surface::calc_liq_soil_moisture </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute liquid portion of the total soil moisture. </p>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l01521">1521</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="program__setup_8F90_source.html#l00138">program_setup::bb_target</a>, <a class="el" href="surface_8F90_source.html#l00073">blim</a>, <a class="el" href="surface_8F90_source.html#l01665">frh2o()</a>, <a class="el" href="surface_8F90_source.html#l00075">frz_h2o</a>, <a class="el" href="surface_8F90_source.html#l00079">grav</a>, <a class="el" href="surface_8F90_source.html#l00081">hlice</a>, <a class="el" href="model__grid_8F90_source.html#l00073">model_grid::landmask_target_grid</a>, <a class="el" href="program__setup_8F90_source.html#l00133">program_setup::maxsmc_target</a>, <a class="el" href="program__setup_8F90_source.html#l00139">program_setup::satpsi_target</a>, <a class="el" href="surface__target__data_8F90_source.html#l00051">surface_target_data::soil_temp_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00033">static_data::soil_type_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00053">surface_target_data::soilm_liq_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00055">surface_target_data::soilm_tot_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00057">veg_type_landice_target</a>, and <a class="el" href="static__data_8F90_source.html#l00036">static_data::veg_type_target_grid</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="a7d2198fe7684f6f0da6f35863f90e931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d2198fe7684f6f0da6f35863f90e931">&#9670;&nbsp;</a></span>cleanup_all_target_sfc_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine surface::cleanup_all_target_sfc_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free up memory once the target grid surface fields are no longer needed. </p>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l03714">3714</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="surface__target__data_8F90_source.html#l00123">surface_target_data::cleanup_target_sfc_data()</a>, <a class="el" href="surface_8F90_source.html#l00063">soil_type_from_input_grid</a>, <a class="el" href="surface_8F90_source.html#l00066">terrain_from_input_grid</a>, and <a class="el" href="surface_8F90_source.html#l00069">terrain_from_input_grid_land</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="a0072f75a8c94bd12bc0e84d392cec723"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0072f75a8c94bd12bc0e84d392cec723">&#9670;&nbsp;</a></span>create_nst_esmf_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public surface::create_nst_esmf_fields </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create ESMF fields for the target grid nst variables. </p>
<dl class="section author"><dt>Author</dt><dd>George Gayno </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l03200">3200</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="surface__target__data_8F90_source.html#l00073">surface_target_data::c_0_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00071">surface_target_data::c_d_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00075">surface_target_data::d_conv_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00077">surface_target_data::dt_cool_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00079">surface_target_data::ifd_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00082">surface_target_data::qrain_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00054">model_grid::target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00084">surface_target_data::tref_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00088">surface_target_data::w_0_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00086">surface_target_data::w_d_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00090">surface_target_data::xs_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00093">surface_target_data::xt_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00104">surface_target_data::xtts_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00096">surface_target_data::xu_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00099">surface_target_data::xv_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00102">surface_target_data::xz_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00106">surface_target_data::xzts_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00108">surface_target_data::z_c_target_grid</a>, and <a class="el" href="surface__target__data_8F90_source.html#l00110">surface_target_data::zm_target_grid</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="a0eeed6bc8807704d095c5356d5026518"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0eeed6bc8807704d095c5356d5026518">&#9670;&nbsp;</a></span>create_surface_esmf_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public surface::create_surface_esmf_fields </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create ESMF fields for the target grid surface variables. </p>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l02760">2760</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="surface__target__data_8F90_source.html#l00018">surface_target_data::canopy_mc_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00020">surface_target_data::f10m_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00023">surface_target_data::ffmm_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00026">surface_target_data::ice_temp_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00067">surface_target_data::lai_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00025">model_grid::lsoil_target</a>, <a class="el" href="surface__target__data_8F90_source.html#l00028">surface_target_data::q2m_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00030">surface_target_data::seaice_depth_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00032">surface_target_data::seaice_fract_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00034">surface_target_data::seaice_skin_temp_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00036">surface_target_data::skin_temp_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00049">surface_target_data::snow_depth_at_ice_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00047">surface_target_data::snow_depth_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00044">surface_target_data::snow_liq_equiv_at_ice_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00042">surface_target_data::snow_liq_equiv_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00051">surface_target_data::soil_temp_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00063">soil_type_from_input_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00053">surface_target_data::soilm_liq_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00055">surface_target_data::soilm_tot_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00040">surface_target_data::srflag_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00038">surface_target_data::sst_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00057">surface_target_data::t2m_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00054">model_grid::target_grid</a>, <a class="el" href="surface_8F90_source.html#l00066">terrain_from_input_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00059">surface_target_data::tprcp_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00061">surface_target_data::ustar_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00063">surface_target_data::z0_ice_target_grid</a>, and <a class="el" href="surface__target__data_8F90_source.html#l00065">surface_target_data::z0_water_target_grid</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="a28f896df0eb043882b4758dfc9ae1aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28f896df0eb043882b4758dfc9ae1aae">&#9670;&nbsp;</a></span>frh2o()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function surface::frh2o </td>
          <td>(</td>
          <td class="paramtype">real(esmf_kind_r8)&#160;</td>
          <td class="paramname"><em>TKELV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(esmf_kind_r8)&#160;</td>
          <td class="paramname"><em>SMC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(esmf_kind_r8)&#160;</td>
          <td class="paramname"><em>SH2O</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>SMCMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>BEXP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>PSIS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate supercooled soil moisture. </p>
<p>Calculate amount of supercooled liquid soil water content if temperature is below 273.15K. Requires Newton-type iteration to solve the nonlinear implicit equation given in eqn 17 of Koren et. al (1999, JGR, VOL 104(D16), 19569-19585).</p>
<p>New version (June 2001): Much faster and more accurate Newton iteration achieved by first taking log of eqn cited above &ndash; less than 4 (typically 1 or 2) iterations achieves convergence. Also, explicit 1-step solution option for special case of parameter ck=0, which reduces the original implicit equation to a simpler explicit form, known as the "Flerchinger eqn". Improved handling of solution in the limit of freezing point temperature.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tkelv</td><td>Temperature (Kelvin) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">smc</td><td>Total soil moisture content (volumetric) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sh2O</td><td>Liquid soil moisture content (volumetric) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">smcmax</td><td>Saturation soil moisture content </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bexp</td><td>Soil type "b" parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psis</td><td>Saturated soil matric potential </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>frh2O Supercooled liquid water content</dd></dl>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-05-20 </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l01665">1665</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="surface_8F90_source.html#l00073">blim</a>, <a class="el" href="surface_8F90_source.html#l00075">frz_h2o</a>, <a class="el" href="surface_8F90_source.html#l00079">grav</a>, and <a class="el" href="surface_8F90_source.html#l00081">hlice</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l01521">calc_liq_soil_moisture()</a>.</p>

</div>
</div>
<a id="a7a2257539e521c7e72bd2b3c76f72044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a2257539e521c7e72bd2b3c76f72044">&#9670;&nbsp;</a></span>ij_to_i_j()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine surface::ij_to_i_j </td>
          <td>(</td>
          <td class="paramtype">integer(esmf_kind_i4), intent(in)&#160;</td>
          <td class="paramname"><em>ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jtile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert 1d index to 2d indices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ij</td><td>the 1d index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itile</td><td>i-dimension of the tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jtile</td><td>j-dimension of the tile </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">i</td><td>the "i" index </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">j</td><td>the "j" index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l03421">3421</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00262">interp()</a>, and <a class="el" href="surface_8F90_source.html#l03457">regrid_many()</a>.</p>

</div>
</div>
<a id="ae8b708efb5c1abfda4a2efc48bef83dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8b708efb5c1abfda4a2efc48bef83dd">&#9670;&nbsp;</a></span>interp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public surface::interp </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>localpet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Horizontally interpolate surface fields from input to target FV3 grid using esmf routines. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">localpet</td><td>ESMF local persistent execution thread</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00262">262</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="surface__target__data_8F90_source.html#l00073">surface_target_data::c_0_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00071">surface_target_data::c_d_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00018">surface_target_data::canopy_mc_target_grid</a>, <a class="el" href="program__setup_8F90_source.html#l00098">program_setup::convert_nst</a>, <a class="el" href="surface__target__data_8F90_source.html#l00075">surface_target_data::d_conv_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00077">surface_target_data::dt_cool_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00020">surface_target_data::f10m_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00023">surface_target_data::ffmm_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00037">model_grid::i_target</a>, <a class="el" href="surface__target__data_8F90_source.html#l00026">surface_target_data::ice_temp_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00079">surface_target_data::ifd_target_grid</a>, <a class="el" href="surface_8F90_source.html#l03421">ij_to_i_j()</a>, <a class="el" href="model__grid_8F90_source.html#l00052">model_grid::input_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00040">model_grid::j_target</a>, <a class="el" href="program__setup_8F90_source.html#l00122">program_setup::lai_from_climo</a>, <a class="el" href="surface__target__data_8F90_source.html#l00067">surface_target_data::lai_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00073">model_grid::landmask_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00078">model_grid::latitude_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00025">model_grid::lsoil_target</a>, <a class="el" href="static__data_8F90_source.html#l00029">static_data::max_veg_greenness_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00030">static_data::min_veg_greenness_target_grid</a>, <a class="el" href="program__setup_8F90_source.html#l00118">program_setup::minmax_vgfrc_from_climo</a>, <a class="el" href="model__grid_8F90_source.html#l00049">model_grid::num_tiles_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00028">surface_target_data::q2m_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00082">surface_target_data::qrain_target_grid</a>, <a class="el" href="surface_8F90_source.html#l03457">regrid_many()</a>, <a class="el" href="surface__target__data_8F90_source.html#l00030">surface_target_data::seaice_depth_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00032">surface_target_data::seaice_fract_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00034">surface_target_data::seaice_skin_temp_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00094">model_grid::seamask_target_grid</a>, <a class="el" href="search__util_8F90_source.html#l00047">search_util::search()</a>, <a class="el" href="surface_8F90_source.html#l03602">search_many()</a>, <a class="el" href="surface__target__data_8F90_source.html#l00036">surface_target_data::skin_temp_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00049">surface_target_data::snow_depth_at_ice_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00047">surface_target_data::snow_depth_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00044">surface_target_data::snow_liq_equiv_at_ice_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00042">surface_target_data::snow_liq_equiv_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00051">surface_target_data::soil_temp_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00063">soil_type_from_input_grid</a>, <a class="el" href="static__data_8F90_source.html#l00033">static_data::soil_type_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00055">surface_target_data::soilm_tot_target_grid</a>, <a class="el" href="program__setup_8F90_source.html#l00108">program_setup::sotyp_from_climo</a>, <a class="el" href="surface__target__data_8F90_source.html#l00040">surface_target_data::srflag_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00038">surface_target_data::sst_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00034">static_data::substrate_temp_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00057">surface_target_data::t2m_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00054">model_grid::target_grid</a>, <a class="el" href="surface_8F90_source.html#l00066">terrain_from_input_grid</a>, <a class="el" href="surface_8F90_source.html#l00069">terrain_from_input_grid_land</a>, <a class="el" href="atm__input__data_8F90_source.html#l00054">atm_input_data::terrain_input_grid</a>, <a class="el" href="program__setup_8F90_source.html#l00125">program_setup::tg3_from_soil</a>, <a class="el" href="surface__target__data_8F90_source.html#l00059">surface_target_data::tprcp_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00084">surface_target_data::tref_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00061">surface_target_data::ustar_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00035">static_data::veg_greenness_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00057">veg_type_landice_target</a>, <a class="el" href="static__data_8F90_source.html#l00036">static_data::veg_type_target_grid</a>, <a class="el" href="program__setup_8F90_source.html#l00113">program_setup::vgfrc_from_climo</a>, <a class="el" href="program__setup_8F90_source.html#l00104">program_setup::vgtyp_from_climo</a>, <a class="el" href="surface__target__data_8F90_source.html#l00088">surface_target_data::w_0_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00086">surface_target_data::w_d_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00090">surface_target_data::xs_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00093">surface_target_data::xt_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00104">surface_target_data::xtts_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00096">surface_target_data::xu_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00099">surface_target_data::xv_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00102">surface_target_data::xz_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00106">surface_target_data::xzts_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00065">surface_target_data::z0_water_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00108">surface_target_data::z_c_target_grid</a>, and <a class="el" href="surface__target__data_8F90_source.html#l00110">surface_target_data::zm_target_grid</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="a37509f4fa66fcf75ee97f82cb99927b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37509f4fa66fcf75ee97f82cb99927b9">&#9670;&nbsp;</a></span>nst_land_fill()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public surface::nst_land_fill </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>nst is not active at land or sea ice points. </p>
<p>Set nst fields to flag values at these points.</p>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l02667">2667</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="surface__target__data_8F90_source.html#l00073">surface_target_data::c_0_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00071">surface_target_data::c_d_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00075">surface_target_data::d_conv_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00077">surface_target_data::dt_cool_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00077">frz_ice</a>, <a class="el" href="surface__target__data_8F90_source.html#l00079">surface_target_data::ifd_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00082">surface_target_data::qrain_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00032">surface_target_data::seaice_fract_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00094">model_grid::seamask_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00036">surface_target_data::skin_temp_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00084">surface_target_data::tref_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00088">surface_target_data::w_0_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00086">surface_target_data::w_d_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00090">surface_target_data::xs_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00093">surface_target_data::xt_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00104">surface_target_data::xtts_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00096">surface_target_data::xu_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00099">surface_target_data::xv_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00102">surface_target_data::xz_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00106">surface_target_data::xzts_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00108">surface_target_data::z_c_target_grid</a>, and <a class="el" href="surface__target__data_8F90_source.html#l00110">surface_target_data::zm_target_grid</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="a232ef616dae3429cdd609b34ed59dcb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a232ef616dae3429cdd609b34ed59dcb1">&#9670;&nbsp;</a></span>qc_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine surface::qc_check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform some quality control checks and set flag values at non-active points. </p>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l02240">2240</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="static__data_8F90_source.html#l00025">static_data::alnsf_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00026">static_data::alnwf_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00023">static_data::alvsf_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00024">static_data::alvwf_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00018">surface_target_data::canopy_mc_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00027">static_data::facsf_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00028">static_data::facwf_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00077">frz_ice</a>, <a class="el" href="surface__target__data_8F90_source.html#l00026">surface_target_data::ice_temp_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00073">model_grid::landmask_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00029">static_data::max_veg_greenness_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00030">static_data::min_veg_greenness_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00084">missing</a>, <a class="el" href="static__data_8F90_source.html#l00031">static_data::mxsno_albedo_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00030">surface_target_data::seaice_depth_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00032">surface_target_data::seaice_fract_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00034">surface_target_data::seaice_skin_temp_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00094">model_grid::seamask_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00036">surface_target_data::skin_temp_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00032">static_data::slope_type_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00049">surface_target_data::snow_depth_at_ice_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00047">surface_target_data::snow_depth_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00044">surface_target_data::snow_liq_equiv_at_ice_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00042">surface_target_data::snow_liq_equiv_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00051">surface_target_data::soil_temp_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00033">static_data::soil_type_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00053">surface_target_data::soilm_liq_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00055">surface_target_data::soilm_tot_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00038">surface_target_data::sst_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00034">static_data::substrate_temp_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00035">static_data::veg_greenness_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00057">veg_type_landice_target</a>, and <a class="el" href="static__data_8F90_source.html#l00036">static_data::veg_type_target_grid</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="a5c687bf7da96c3c512b13a6a7eab4b99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c687bf7da96c3c512b13a6a7eab4b99">&#9670;&nbsp;</a></span>regrid_many()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public surface::regrid_many </td>
          <td>(</td>
          <td class="paramtype">type(esmf_fieldbundle), intent(in)&#160;</td>
          <td class="paramname"><em>bundle_pre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(esmf_fieldbundle), intent(in)&#160;</td>
          <td class="paramname"><em>bundle_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>num_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(esmf_routehandle), intent(inout)&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(num_field), intent(in)&#160;</td>
          <td class="paramname"><em>dozero</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(esmf_kind_i4), dimension(:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>unmapped_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>resetifd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regrid multiple ESMF fields from input to target grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bundle_pre</td><td>ESMF fieldBundle on input grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bundle_post</td><td>ESMF fieldBundle on target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_field</td><td>Number of fields in target field pointer </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">route</td><td>Route handle to saved ESMF regridding instructions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dozero</td><td>Logical length num_field for whether field should be zeroed out before regridding </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">unmapped_ptr</td><td>(optional) Pointer to unmapped points from FieldRegrid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resetifd</td><td>(optional) Logical for whether to reset ifd (only for water where nst data is used) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Larissa Reames, OU CIMMS/NOAA/NSSL </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l03457">3457</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="program__setup_8F90_source.html#l00098">program_setup::convert_nst</a>, <a class="el" href="model__grid_8F90_source.html#l00037">model_grid::i_target</a>, <a class="el" href="surface__target__data_8F90_source.html#l00079">surface_target_data::ifd_target_grid</a>, <a class="el" href="surface_8F90_source.html#l03421">ij_to_i_j()</a>, and <a class="el" href="model__grid_8F90_source.html#l00040">model_grid::j_target</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00262">interp()</a>.</p>

</div>
</div>
<a id="a63fb2a0ed00bdec5e4f0b3360a5709a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63fb2a0ed00bdec5e4f0b3360a5709a6">&#9670;&nbsp;</a></span>rescale_soil_moisture()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine surface::rescale_soil_moisture </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjust soil moisture for changes in soil type between the input and target grids. </p>
<p>Works for Noah land model only. Required to preserve latent/sensible heat fluxes.</p>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l01803">1803</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="program__setup_8F90_source.html#l00130">program_setup::drysmc_input</a>, <a class="el" href="program__setup_8F90_source.html#l00131">program_setup::drysmc_target</a>, <a class="el" href="model__grid_8F90_source.html#l00073">model_grid::landmask_target_grid</a>, <a class="el" href="program__setup_8F90_source.html#l00132">program_setup::maxsmc_input</a>, <a class="el" href="program__setup_8F90_source.html#l00133">program_setup::maxsmc_target</a>, <a class="el" href="program__setup_8F90_source.html#l00134">program_setup::refsmc_input</a>, <a class="el" href="program__setup_8F90_source.html#l00135">program_setup::refsmc_target</a>, <a class="el" href="surface_8F90_source.html#l00063">soil_type_from_input_grid</a>, <a class="el" href="static__data_8F90_source.html#l00033">static_data::soil_type_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00055">surface_target_data::soilm_tot_target_grid</a>, <a class="el" href="static__data_8F90_source.html#l00035">static_data::veg_greenness_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00057">veg_type_landice_target</a>, <a class="el" href="static__data_8F90_source.html#l00036">static_data::veg_type_target_grid</a>, <a class="el" href="program__setup_8F90_source.html#l00136">program_setup::wltsmc_input</a>, and <a class="el" href="program__setup_8F90_source.html#l00137">program_setup::wltsmc_target</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="ab18f8cebd46379b7b81a69829326eed0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab18f8cebd46379b7b81a69829326eed0">&#9670;&nbsp;</a></span>roughness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine surface::roughness </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set roughness length at points with some sea ice to 1 cm. </p>
<p>Set flag value at points with some or all open water.</p>
<dl class="section author"><dt>Author</dt><dd>George Gayno NOAA/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l02162">2162</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="model__grid_8F90_source.html#l00073">model_grid::landmask_target_grid</a>, <a class="el" href="surface_8F90_source.html#l00084">missing</a>, <a class="el" href="surface__target__data_8F90_source.html#l00032">surface_target_data::seaice_fract_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00094">model_grid::seamask_target_grid</a>, <a class="el" href="surface__target__data_8F90_source.html#l00063">surface_target_data::z0_ice_target_grid</a>, and <a class="el" href="surface__target__data_8F90_source.html#l00065">surface_target_data::z0_water_target_grid</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<a id="afc2c63e91ef5af4cefca13d9673d4acc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc2c63e91ef5af4cefca13d9673d4acc">&#9670;&nbsp;</a></span>search_many()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public surface::search_many </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>num_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(esmf_fieldbundle), intent(inout)&#160;</td>
          <td class="paramname"><em>bundle_target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(num_field), intent(inout)&#160;</td>
          <td class="paramname"><em>search_nums</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>localpet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(esmf_kind_r8), dimension(i_target,j_target), intent(inout), optional&#160;</td>
          <td class="paramname"><em>latitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(esmf_kind_r8), dimension(i_target,j_target), intent(inout), optional&#160;</td>
          <td class="paramname"><em>terrain_land</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(esmf_kind_r8), dimension(i_target,j_target), intent(inout), optional&#160;</td>
          <td class="paramname"><em>soilt_climo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(esmf_kind_i8), dimension(i_target,j_target), intent(inout), optional&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the search function for multple fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">num_field</td><td>Number of fields to process. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bundle_target</td><td>ESMF FieldBundle holding target fields to search </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tile</td><td>Current cubed sphere tile. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">search_nums</td><td>Array length num_field holding search field numbers corresponding to each field provided for searching. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">localpet</td><td>ESMF local persistent execution thread. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">latitude</td><td>(optional) A real array size i_target,j_target of latitude on the target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">terrain_land</td><td>(optional) A real array size i_target,j_target of terrain height (m) on the target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">soilt_climo</td><td>(optional) A real array size i_target,j_target of climatological soil type on the target grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mask</td><td>(optional) An integer array of size i_target,j_target that holds masked (0) and unmasked (1) values indicating where to execute search (only at </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l03602">3602</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="program__setup_8F90_source.html#l00057">program_setup::external_model</a>, <a class="el" href="model__grid_8F90_source.html#l00037">model_grid::i_target</a>, <a class="el" href="program__setup_8F90_source.html#l00043">program_setup::input_type</a>, <a class="el" href="model__grid_8F90_source.html#l00040">model_grid::j_target</a>, <a class="el" href="model__grid_8F90_source.html#l00025">model_grid::lsoil_target</a>, and <a class="el" href="search__util_8F90_source.html#l00047">search_util::search()</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00262">interp()</a>.</p>

</div>
</div>
<a id="a0707121ff6af9350608125b1750e32f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0707121ff6af9350608125b1750e32f5">&#9670;&nbsp;</a></span>surface_driver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public surface::surface_driver </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>localpet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Driver routine to process surface/nst data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">localpet</td><td>ESMF local persistent execution thread</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>George Gayno NCEP/EMC </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00115">115</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="surface_8F90_source.html#l02047">adjust_soil_levels()</a>, <a class="el" href="surface_8F90_source.html#l01971">adjust_soilt_for_terrain()</a>, <a class="el" href="surface_8F90_source.html#l01521">calc_liq_soil_moisture()</a>, <a class="el" href="program__setup_8F90_source.html#l00520">program_setup::calc_soil_params_driver()</a>, <a class="el" href="surface_8F90_source.html#l03714">cleanup_all_target_sfc_data()</a>, <a class="el" href="static__data_8F90_source.html#l00555">static_data::cleanup_static_fields()</a>, <a class="el" href="surface__target__data_8F90_source.html#l00161">surface_target_data::cleanup_target_nst_data()</a>, <a class="el" href="program__setup_8F90_source.html#l00098">program_setup::convert_nst</a>, <a class="el" href="surface_8F90_source.html#l03200">create_nst_esmf_fields()</a>, <a class="el" href="surface_8F90_source.html#l02760">create_surface_esmf_fields()</a>, <a class="el" href="static__data_8F90_source.html#l00050">static_data::get_static_fields()</a>, <a class="el" href="surface_8F90_source.html#l00262">interp()</a>, <a class="el" href="surface_8F90_source.html#l02667">nst_land_fill()</a>, <a class="el" href="surface_8F90_source.html#l02240">qc_check()</a>, <a class="el" href="surface_8F90_source.html#l01803">rescale_soil_moisture()</a>, <a class="el" href="surface_8F90_source.html#l02162">roughness()</a>, and <a class="el" href="surface_8F90_source.html#l03362">update_landmask()</a>.</p>

<p class="reference">Referenced by <a class="el" href="chgres_8F90_source.html#l00024">chgres()</a>.</p>

</div>
</div>
<a id="a48b3ef0181a25662f39eca384b3c1194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48b3ef0181a25662f39eca384b3c1194">&#9670;&nbsp;</a></span>update_landmask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine surface::update_landmask </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update landmask for sea ice. </p>
<p>The model requires the landmask record be present. However, the data is recomputed in FV3ATM routine fv3atm_sfc_io.F90 after it is read in. Here, compute it using the same algorithm as the model and output it as a diagnostic.</p>
<dl class="section author"><dt>Author</dt><dd>George Gayno </dd></dl>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l03362">3362</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">References <a class="el" href="model__grid_8F90_source.html#l00076">model_grid::land_frac_target_grid</a>, <a class="el" href="model__grid_8F90_source.html#l00073">model_grid::landmask_target_grid</a>, and <a class="el" href="surface__target__data_8F90_source.html#l00032">surface_target_data::seaice_fract_target_grid</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l00115">surface_driver()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8504e69c586b0d22fd77f08056996bec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8504e69c586b0d22fd77f08056996bec">&#9670;&nbsp;</a></span>blim</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter, private surface::blim = 5.5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>soil 'b' parameter limit </p>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00073">73</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l01521">calc_liq_soil_moisture()</a>, and <a class="el" href="surface_8F90_source.html#l01665">frh2o()</a>.</p>

</div>
</div>
<a id="a38ac050f3afcffb171ecaca67f4338c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38ac050f3afcffb171ecaca67f4338c6">&#9670;&nbsp;</a></span>frz_h2o</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter, private surface::frz_h2o = 273.15</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>melting pt water </p>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00075">75</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l01521">calc_liq_soil_moisture()</a>, and <a class="el" href="surface_8F90_source.html#l01665">frh2o()</a>.</p>

</div>
</div>
<a id="a8c9df7d4a32c856503c625212b2f2fe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c9df7d4a32c856503c625212b2f2fe4">&#9670;&nbsp;</a></span>frz_ice</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter, private surface::frz_ice = 271.21</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>melting pt sea ice </p>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00077">77</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l02667">nst_land_fill()</a>, and <a class="el" href="surface_8F90_source.html#l02240">qc_check()</a>.</p>

</div>
</div>
<a id="a0d020b9469b9e3dd472fa76b0c4ded06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d020b9469b9e3dd472fa76b0c4ded06">&#9670;&nbsp;</a></span>grav</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter, private surface::grav = 9.81</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>gravity </p>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00079">79</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l01521">calc_liq_soil_moisture()</a>, and <a class="el" href="surface_8F90_source.html#l01665">frh2o()</a>.</p>

</div>
</div>
<a id="af4df26877e3d05576cc7cd54ec22c204"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4df26877e3d05576cc7cd54ec22c204">&#9670;&nbsp;</a></span>hlice</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter, private surface::hlice = 3.335E5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>latent heat of fusion </p>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00081">81</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l01521">calc_liq_soil_moisture()</a>, and <a class="el" href="surface_8F90_source.html#l01665">frh2o()</a>.</p>

</div>
</div>
<a id="ad1c448e5b9b098f82e00ea37a3d083f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1c448e5b9b098f82e00ea37a3d083f4">&#9670;&nbsp;</a></span>missing</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(esmf_kind_r8), parameter, private surface::missing = -1.e20_esmf_kind_r8</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>flag for non-active points. </p>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00084">84</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l02240">qc_check()</a>, and <a class="el" href="surface_8F90_source.html#l02162">roughness()</a>.</p>

</div>
</div>
<a id="a2150daf83b917a49662ed6473e8e5097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2150daf83b917a49662ed6473e8e5097">&#9670;&nbsp;</a></span>soil_type_from_input_grid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(esmf_field) surface::soil_type_from_input_grid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>soil type interpolated from input grid </p>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00063">63</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l03714">cleanup_all_target_sfc_data()</a>, <a class="el" href="surface_8F90_source.html#l02760">create_surface_esmf_fields()</a>, <a class="el" href="surface_8F90_source.html#l00262">interp()</a>, and <a class="el" href="surface_8F90_source.html#l01803">rescale_soil_moisture()</a>.</p>

</div>
</div>
<a id="ab770243d8fd686d14b4eaec335eb7b15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab770243d8fd686d14b4eaec335eb7b15">&#9670;&nbsp;</a></span>terrain_from_input_grid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(esmf_field) surface::terrain_from_input_grid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>terrain height interpolated from input grid </p>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00066">66</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l01971">adjust_soilt_for_terrain()</a>, <a class="el" href="surface_8F90_source.html#l03714">cleanup_all_target_sfc_data()</a>, <a class="el" href="surface_8F90_source.html#l02760">create_surface_esmf_fields()</a>, and <a class="el" href="surface_8F90_source.html#l00262">interp()</a>.</p>

</div>
</div>
<a id="a6dde2acec84877a91162b4bcf795373e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dde2acec84877a91162b4bcf795373e">&#9670;&nbsp;</a></span>terrain_from_input_grid_land</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(esmf_field) surface::terrain_from_input_grid_land</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>terrain height interpolated from input grid at all land points </p>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00069">69</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l03714">cleanup_all_target_sfc_data()</a>, and <a class="el" href="surface_8F90_source.html#l00262">interp()</a>.</p>

</div>
</div>
<a id="a7aedcff2da595ef7aac69152edbdfa64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aedcff2da595ef7aac69152edbdfa64">&#9670;&nbsp;</a></span>veg_type_landice_target</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter surface::veg_type_landice_target = 15</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vegetation type category that defines permanent land ice points. </p>
<p>The Noah LSM land ice physics are applied at these points. </p>

<p class="definition">Definition at line <a class="el" href="surface_8F90_source.html#l00057">57</a> of file <a class="el" href="surface_8F90_source.html">surface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="surface_8F90_source.html#l01971">adjust_soilt_for_terrain()</a>, <a class="el" href="surface_8F90_source.html#l01521">calc_liq_soil_moisture()</a>, <a class="el" href="surface_8F90_source.html#l00262">interp()</a>, <a class="el" href="surface_8F90_source.html#l02240">qc_check()</a>, and <a class="el" href="surface_8F90_source.html#l01803">rescale_soil_moisture()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesurface.html">surface</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
