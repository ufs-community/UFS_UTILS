<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>global_cycle: /scratch1/NCEPDEV/da/George.Gayno/ufs_utils.git/UFS_UTILS.upstream/sorc/global_cycle.fd/cycle.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">global_cycle
   &#160;<span id="projectnumber">1.13.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('cycle_8f90.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">cycle.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Update surface and NSST fields.  
<a href="#details">More...</a></p>

<p><a href="cycle_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aaf7d5f710e03e2a8289a4c4090f8d8f7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#aaf7d5f710e03e2a8289a4c4090f8d8f7">adjust_nsst</a> (RLA, RLO, SLMSK_TILE, SLMSK_FG_TILE, SKINT_TILE, SICET_TILE, sice_tile, sice_fg_tile, SOILT_TILE, NSST, LENSFC, LSOIL, IDIM, JDIM, ZSEA1, ZSEA2, tf_clm_tile, tf_trd_tile, sal_clm_tile, LANDFRAC, FRAC_GRID)</td></tr>
<tr class="memdesc:aaf7d5f710e03e2a8289a4c4090f8d8f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read in gsi file with the updated reference temperature increments (on the gaussian grid), interpolate increments to the cubed-sphere tile, and perform required nsst adjustments and qc.  <a href="#aaf7d5f710e03e2a8289a4c4090f8d8f7">More...</a><br /></td></tr>
<tr class="separator:aaf7d5f710e03e2a8289a4c4090f8d8f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46fe0ab692bbe423b224c4c64d6ea687"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#a46fe0ab692bbe423b224c4c64d6ea687">climo_trend</a> (LATITUDE, MON, DAY, DELTSFC, DTREF)</td></tr>
<tr class="memdesc:a46fe0ab692bbe423b224c4c64d6ea687"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the tile point is an isolated water point that has no corresponding gsi water point, then tref is updated using the rtg sst climo trend.  <a href="#a46fe0ab692bbe423b224c4c64d6ea687">More...</a><br /></td></tr>
<tr class="separator:a46fe0ab692bbe423b224c4c64d6ea687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afedff26063b46106a823d209bfd4430e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#afedff26063b46106a823d209bfd4430e">dtzm_point</a> (XT, XZ, DT_COOL, ZC, Z1, Z2, DTZM)</td></tr>
<tr class="memdesc:afedff26063b46106a823d209bfd4430e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the vertical mean of the NSST t-profile.  <a href="#afedff26063b46106a823d209bfd4430e">More...</a><br /></td></tr>
<tr class="separator:afedff26063b46106a823d209bfd4430e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa5ccf0addd191b13a3bdfb9558a005b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#aaa5ccf0addd191b13a3bdfb9558a005b">get_sal_clm</a> (xlats_ij, xlons_ij, ny, nx, iy, im, id, ih, sal_clm)</td></tr>
<tr class="memdesc:aaa5ccf0addd191b13a3bdfb9558a005b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get salinity climatology at the valid time on the target grid.  <a href="#aaa5ccf0addd191b13a3bdfb9558a005b">More...</a><br /></td></tr>
<tr class="separator:aaa5ccf0addd191b13a3bdfb9558a005b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cb5a7888d49b29e0b30e5ca206f7294"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#a6cb5a7888d49b29e0b30e5ca206f7294">get_sal_clm_ta</a> (sal_clm_ta, xlats, xlons, nlat, nlon, mon1, mon2, wei1, wei2)</td></tr>
<tr class="memdesc:a6cb5a7888d49b29e0b30e5ca206f7294"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get climatological salinity at the analysis time.  <a href="#a6cb5a7888d49b29e0b30e5ca206f7294">More...</a><br /></td></tr>
<tr class="separator:a6cb5a7888d49b29e0b30e5ca206f7294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6a9017387ab47706fdac2c2c0593f0a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#ad6a9017387ab47706fdac2c2c0593f0a">get_tf_clm</a> (xlats_ij, xlons_ij, ny, nx, iy, im, id, ih, tf_clm, tf_trd)</td></tr>
<tr class="memdesc:ad6a9017387ab47706fdac2c2c0593f0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the sst climatology at the valid time and on the target grid.  <a href="#ad6a9017387ab47706fdac2c2c0593f0a">More...</a><br /></td></tr>
<tr class="separator:ad6a9017387ab47706fdac2c2c0593f0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dd48dac426c3c605ce62a2d868a72c3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#a7dd48dac426c3c605ce62a2d868a72c3">get_tf_clm_ta</a> (tf_clm_ta, tf_clm_trend, xlats, xlons, nlat, nlon, mon1, mon2, wei1, wei2)</td></tr>
<tr class="memdesc:a7dd48dac426c3c605ce62a2d868a72c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the reference temperature/sst climatology and its trend at analysis time.  <a href="#a7dd48dac426c3c605ce62a2d868a72c3">More...</a><br /></td></tr>
<tr class="separator:a7dd48dac426c3c605ce62a2d868a72c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250f9e210a13e3bd9b669f904a279d83"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#a250f9e210a13e3bd9b669f904a279d83">get_tim_wei</a> (iy, im, id, ih, mon1, mon2, wei1, wei2)</td></tr>
<tr class="memdesc:a250f9e210a13e3bd9b669f904a279d83"><td class="mdescLeft">&#160;</td><td class="mdescRight">For a given date, determine the bounding months and the linear time interpolation weights.  <a href="#a250f9e210a13e3bd9b669f904a279d83">More...</a><br /></td></tr>
<tr class="separator:a250f9e210a13e3bd9b669f904a279d83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37a1ed396c350a20fed5c59a05dbb59"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#ab37a1ed396c350a20fed5c59a05dbb59">intp_tile</a> (tf_lalo, dlats_lalo, dlons_lalo, jdim_lalo, idim_lalo, tf_tile, xlats_tile, xlons_tile, jdim_tile, idim_tile)</td></tr>
<tr class="memdesc:ab37a1ed396c350a20fed5c59a05dbb59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate lon/lat grid data to the fv3 native grid (tf_lalo =&gt; tf_tile).  <a href="#ab37a1ed396c350a20fed5c59a05dbb59">More...</a><br /></td></tr>
<tr class="separator:ab37a1ed396c350a20fed5c59a05dbb59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8c1e8a1a1b952babdabb8122a4e2fda"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#af8c1e8a1a1b952babdabb8122a4e2fda">nsst_water_reset</a> (nsst, ij, tf_thaw)</td></tr>
<tr class="memdesc:af8c1e8a1a1b952babdabb8122a4e2fda"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the first guess was sea ice, but the analysis is open water, reset all nsst variables.  <a href="#af8c1e8a1a1b952babdabb8122a4e2fda">More...</a><br /></td></tr>
<tr class="separator:af8c1e8a1a1b952babdabb8122a4e2fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ccda063fdf438966bca8efde5c6cd03"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#a9ccda063fdf438966bca8efde5c6cd03">sfc_drv</a></td></tr>
<tr class="memdesc:a9ccda063fdf438966bca8efde5c6cd03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stand alone surface/NSST cycle driver for the cubed-sphere grid.  <a href="#a9ccda063fdf438966bca8efde5c6cd03">More...</a><br /></td></tr>
<tr class="separator:a9ccda063fdf438966bca8efde5c6cd03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6a36c7ea36884692de56e4643fa16ef"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#af6a36c7ea36884692de56e4643fa16ef">sfcdrv</a> (LUGB, IDIM, JDIM, LENSFC, LSOIL, DELTSFC, IY, IM, ID, IH, FH, IALB, USE_UFO, DO_NSST, DO_SFCCYCLE, DO_LNDINC, FRAC_GRID, ZSEA1, ZSEA2, ISOT, IVEGSRC, MYRANK)</td></tr>
<tr class="memdesc:af6a36c7ea36884692de56e4643fa16ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver routine for updating the surface fields.  <a href="#af6a36c7ea36884692de56e4643fa16ef">More...</a><br /></td></tr>
<tr class="separator:af6a36c7ea36884692de56e4643fa16ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade32d73a7d3d2ee2e9813674aea1f797"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#ade32d73a7d3d2ee2e9813674aea1f797">tf_thaw_set</a> (tf_ij, mask_ij, itile, jtile, tice, tclm, tf_thaw, nx, ny, nset_thaw_s, nset_thaw_i, nset_thaw_c)</td></tr>
<tr class="memdesc:ade32d73a7d3d2ee2e9813674aea1f797"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the background reference temperature (tf) for points where the ice has just melted.  <a href="#ade32d73a7d3d2ee2e9813674aea1f797">More...</a><br /></td></tr>
<tr class="separator:ade32d73a7d3d2ee2e9813674aea1f797"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8609bf25108d7ef0c230efe2a92d2517"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cycle_8f90.html#a8609bf25108d7ef0c230efe2a92d2517">tfreez</a> (salinity)</td></tr>
<tr class="memdesc:a8609bf25108d7ef0c230efe2a92d2517"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the freezing point of water as a function of salinity.  <a href="#a8609bf25108d7ef0c230efe2a92d2517">More...</a><br /></td></tr>
<tr class="separator:a8609bf25108d7ef0c230efe2a92d2517"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Update surface and NSST fields. </p>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell NCEP/EMC </dd></dl>

<p class="definition">Definition in file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aaf7d5f710e03e2a8289a4c4090f8d8f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf7d5f710e03e2a8289a4c4090f8d8f7">&#9670;&nbsp;</a></span>adjust_nsst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine adjust_nsst </td>
          <td>(</td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>RLA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>RLO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>SLMSK_TILE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>SLMSK_FG_TILE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(inout)&#160;</td>
          <td class="paramname"><em>SKINT_TILE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(inout)&#160;</td>
          <td class="paramname"><em>SICET_TILE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>sice_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>sice_fg_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc,lsoil), intent(inout)&#160;</td>
          <td class="paramname"><em>SOILT_TILE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="namespaceread__write__data.html#structread__write__data_1_1nsst__data">nsst_data</a>)&#160;</td>
          <td class="paramname"><em>NSST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LENSFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LSOIL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>JDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ZSEA1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ZSEA2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>tf_clm_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>tf_trd_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>sal_clm_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(lensfc), intent(in)&#160;</td>
          <td class="paramname"><em>LANDFRAC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>FRAC_GRID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read in gsi file with the updated reference temperature increments (on the gaussian grid), interpolate increments to the cubed-sphere tile, and perform required nsst adjustments and qc. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">RLA</td><td>Latitude on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RLO</td><td>Longitude on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SLMSK_TILE</td><td>Land-sea mask on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SLMSK_FG_TILE</td><td>First guess land-sea mask on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">SKINT_TILE</td><td>Skin temperature on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">SICET_TILE</td><td>Ice temperature on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sice_tile</td><td>Ice concentration on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sice_fg_tile</td><td>First guess ice concentration on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">SOILT_TILE</td><td>Soil temperature on the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NSST</td><td>Data structure holding nsst fields </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LENSFC</td><td>Number of points on a tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LSOIL</td><td>Number of soil layers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IDIM</td><td>'I' dimension of a tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">JDIM</td><td>'J' dimension of a tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ZSEA1</td><td>When running nsst model, this is the lower bound of depth of sea temperature. In whole mm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ZSEA2</td><td>When running nsst model, this is the upper bound of depth of sea temperature. In whole mm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tf_clm_tile</td><td>Climatological reference temperature on the cubed-sphere tile. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tf_trd_tile</td><td>Climatolocial reference temperature trend on the cubed-sphere tile. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sal_clm_tile</td><td>Climatological salinity on the cubed-sphere tile. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LANDFRAC</td><td>Land fraction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">FRAC_GRID</td><td>Process fractional grid when true.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li, George Gayno </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l00926">926</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">References <a class="el" href="read__write__data_8f90_source.html#l00049">read_write_data::dtref_gaus</a>, <a class="el" href="cycle_8f90_source.html#l01503">dtzm_point()</a>, <a class="el" href="read__write__data_8f90_source.html#l00038">read_write_data::idim_gaus</a>, <a class="el" href="read__write__data_8f90_source.html#l00040">read_write_data::jdim_gaus</a>, <a class="el" href="cycle_8f90_source.html#l01666">nsst_water_reset()</a>, <a class="el" href="utils_8F90_source.html#l00040">utils::remap_coef()</a>, <a class="el" href="read__write__data_8f90_source.html#l00042">read_write_data::slmsk_gaus</a>, and <a class="el" href="cycle_8f90_source.html#l01576">tf_thaw_set()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l00313">sfcdrv()</a>.</p>

</div>
</div>
<a id="a46fe0ab692bbe423b224c4c64d6ea687"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46fe0ab692bbe423b224c4c64d6ea687">&#9670;&nbsp;</a></span>climo_trend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine climo_trend </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>LATITUDE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>DAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DELTSFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>DTREF</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If the tile point is an isolated water point that has no corresponding gsi water point, then tref is updated using the rtg sst climo trend. </p>
<p>This monthly trend is sorted by latitude band.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">LATITUDE</td><td>Latitude of tile point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MON</td><td>Month </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DAY</td><td>Day </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DELTSFC</td><td>Cycling frequency in hours </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DTREF</td><td>Monthly trend of reference temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li, George Gayno </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l01350">1350</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

</div>
</div>
<a id="afedff26063b46106a823d209bfd4430e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afedff26063b46106a823d209bfd4430e">&#9670;&nbsp;</a></span>dtzm_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dtzm_point </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>XT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>XZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DT_COOL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ZC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>Z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>Z2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>DTZM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the vertical mean of the NSST t-profile. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xt</td><td>Heat content in the diurnal thermocline layer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xz</td><td>Thickness of the diurnal thermocline layer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt_cool</td><td>Skin-layer cooling amount. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zc</td><td>Thickness of skin-layer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z1</td><td>Lower bound of depth of sea temperature. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z2</td><td>Upper bound of depth of sea temperature. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dtzm</td><td>Mean of the NSST t-profile from z1 to z2.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2015 </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l01503">1503</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l00926">adjust_nsst()</a>.</p>

</div>
</div>
<a id="aaa5ccf0addd191b13a3bdfb9558a005b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa5ccf0addd191b13a3bdfb9558a005b">&#9670;&nbsp;</a></span>get_sal_clm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine get_sal_clm </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nx*ny), intent(in)&#160;</td>
          <td class="paramname"><em>xlats_ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx*ny), intent(in)&#160;</td>
          <td class="paramname"><em>xlons_ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ih</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,ny), intent(out)&#160;</td>
          <td class="paramname"><em>sal_clm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get salinity climatology at the valid time on the target grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xlats_ij</td><td>Latitudes of target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlons_ij</td><td>Longitudes of target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>'j' dimension of target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>'i' dimension of target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy</td><td>Year </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">im</td><td>Month </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>Day </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ih</td><td>Hour </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sal_clm</td><td>Salinity climatology on the target grid at the valid time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l01829">1829</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">References <a class="el" href="read__write__data_8f90_source.html#l01922">read_write_data::get_dim_nc()</a>, <a class="el" href="cycle_8f90_source.html#l01889">get_sal_clm_ta()</a>, <a class="el" href="cycle_8f90_source.html#l02023">get_tim_wei()</a>, and <a class="el" href="cycle_8f90_source.html#l01935">intp_tile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l00313">sfcdrv()</a>.</p>

</div>
</div>
<a id="a6cb5a7888d49b29e0b30e5ca206f7294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cb5a7888d49b29e0b30e5ca206f7294">&#9670;&nbsp;</a></span>get_sal_clm_ta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine get_sal_clm_ta </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nlon,nlat), intent(out)&#160;</td>
          <td class="paramname"><em>sal_clm_ta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nlat), intent(out)&#160;</td>
          <td class="paramname"><em>xlats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nlon), intent(out)&#160;</td>
          <td class="paramname"><em>xlons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mon1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mon2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wei1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wei2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get climatological salinity at the analysis time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nlat</td><td>'j' dimension of climatological data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nlon</td><td>'i' dimension of climatological data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mon1</td><td>First bounding month </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mon2</td><td>Second bounding month </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wei1</td><td>Weight of first bounding month </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wei2</td><td>Weight of second bounding month </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sal_clm_ta</td><td>Climatological salinity at the analysis time </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xlats</td><td>Latitudes on the climatological grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xlons</td><td>Longitudes on the climatological grid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 2019 </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l01889">1889</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">References <a class="el" href="read__write__data_8f90_source.html#l01851">read_write_data::read_salclm_gfs_nc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l01829">get_sal_clm()</a>.</p>

</div>
</div>
<a id="ad6a9017387ab47706fdac2c2c0593f0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6a9017387ab47706fdac2c2c0593f0a">&#9670;&nbsp;</a></span>get_tf_clm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine get_tf_clm </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nx*ny), intent(in)&#160;</td>
          <td class="paramname"><em>xlats_ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx*ny), intent(in)&#160;</td>
          <td class="paramname"><em>xlons_ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ih</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,ny), intent(out)&#160;</td>
          <td class="paramname"><em>tf_clm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,ny), intent(out)&#160;</td>
          <td class="paramname"><em>tf_trd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the sst climatology at the valid time and on the target grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xlats_ij</td><td>latitude of target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlons_ij</td><td>longitude of target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>'j' dimension of target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>'i' dimension of target grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy</td><td>Year </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">im</td><td>Month </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>Day </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ih</td><td>Hour </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tf_clm</td><td>sst climatology at the valid time and on the target grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tf_trd</td><td>6-hourly sst climatology tendency at the valid time and on the target grid. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l01712">1712</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">References <a class="el" href="read__write__data_8f90_source.html#l01793">read_write_data::get_tf_clm_dim()</a>, <a class="el" href="cycle_8f90_source.html#l01781">get_tf_clm_ta()</a>, <a class="el" href="cycle_8f90_source.html#l02023">get_tim_wei()</a>, and <a class="el" href="cycle_8f90_source.html#l01935">intp_tile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l00313">sfcdrv()</a>.</p>

</div>
</div>
<a id="a7dd48dac426c3c605ce62a2d868a72c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dd48dac426c3c605ce62a2d868a72c3">&#9670;&nbsp;</a></span>get_tf_clm_ta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine get_tf_clm_ta </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nlon,nlat), intent(out)&#160;</td>
          <td class="paramname"><em>tf_clm_ta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nlon,nlat), intent(out)&#160;</td>
          <td class="paramname"><em>tf_clm_trend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nlat), intent(out)&#160;</td>
          <td class="paramname"><em>xlats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nlon), intent(out)&#160;</td>
          <td class="paramname"><em>xlons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mon1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mon2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wei1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>wei2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the reference temperature/sst climatology and its trend at analysis time. </p>
<p>The data is time interpolated between two bounding months.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">tf_clm_ta</td><td>Climatological tf/sst at analysis time </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tf_clm_trend</td><td>Climatological tf/sst trend at analysis time </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xlats</td><td>Latitudes on the climatological data grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xlons</td><td>Longitudes on the climatological data grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nlat</td><td>'j' dimension on the climatological grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nlon</td><td>'i' dimension on the climatological grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mon1</td><td>First bounding month </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mon2</td><td>Second bounding month </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wei1</td><td>Weighting of first bounding month </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wei2</td><td>Weighting of second bounding month </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 2019 </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l01781">1781</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">References <a class="el" href="read__write__data_8f90_source.html#l01651">read_write_data::read_tf_clim_grb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l01712">get_tf_clm()</a>.</p>

</div>
</div>
<a id="a250f9e210a13e3bd9b669f904a279d83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a250f9e210a13e3bd9b669f904a279d83">&#9670;&nbsp;</a></span>get_tim_wei()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine get_tim_wei </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ih</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>mon1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>mon2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wei1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>wei2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For a given date, determine the bounding months and the linear time interpolation weights. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iy</td><td>The year </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">im</td><td>The month </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>The day </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ih</td><td>The hour </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mon1</td><td>First bounding month </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mon2</td><td>Second bounding month </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">wei1</td><td>Weighting of first bounding month </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">wei2</td><td>Weighting of second bounding month </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 2019 </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l02023">2023</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l01829">get_sal_clm()</a>, and <a class="el" href="cycle_8f90_source.html#l01712">get_tf_clm()</a>.</p>

</div>
</div>
<a id="ab37a1ed396c350a20fed5c59a05dbb59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab37a1ed396c350a20fed5c59a05dbb59">&#9670;&nbsp;</a></span>intp_tile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine intp_tile </td>
          <td>(</td>
          <td class="paramtype">real, dimension(idim_lalo,jdim_lalo), intent(in)&#160;</td>
          <td class="paramname"><em>tf_lalo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(jdim_lalo), intent(in)&#160;</td>
          <td class="paramname"><em>dlats_lalo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(idim_lalo), intent(in)&#160;</td>
          <td class="paramname"><em>dlons_lalo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jdim_lalo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>idim_lalo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(jdim_tile*idim_tile), intent(out)&#160;</td>
          <td class="paramname"><em>tf_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(jdim_tile*idim_tile), intent(in)&#160;</td>
          <td class="paramname"><em>xlats_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(jdim_tile*idim_tile), intent(in)&#160;</td>
          <td class="paramname"><em>xlons_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jdim_tile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>idim_tile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate lon/lat grid data to the fv3 native grid (tf_lalo =&gt; tf_tile). </p>
<p>Does not account for a mask.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tf_lalo</td><td>(idim_lalo,idim_lalo) field on the lat/lon regular grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dlats_lalo</td><td>(jdim_lalo) latitudes along y direction of lat/lon regular grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dlons_lalo</td><td>(idim_lalo) longitudes along x direction of lat/lon regular grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jdim_lalo</td><td>number of y dimension of tf_lalo. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim_lalo</td><td>number of x dimension of tf_lalo. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlats_tile</td><td>(jdim_tile*idim_tile) latitudes of all tile grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlons_tile</td><td>(jdim_tile*idim_tile) longitudes of all tile grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jdim_tile</td><td>number of y dimension of tf_tile. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim_tile</td><td>number of x dimension of tf_tile. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tf_tile</td><td>(jdim_tile*idim_tile) field on the cubed sphere grid. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l01935">1935</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">References <a class="el" href="utils_8F90_source.html#l00040">utils::remap_coef()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l01829">get_sal_clm()</a>, and <a class="el" href="cycle_8f90_source.html#l01712">get_tf_clm()</a>.</p>

</div>
</div>
<a id="af8c1e8a1a1b952babdabb8122a4e2fda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8c1e8a1a1b952babdabb8122a4e2fda">&#9670;&nbsp;</a></span>nsst_water_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nsst_water_reset </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="namespaceread__write__data.html#structread__write__data_1_1nsst__data">nsst_data</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>nsst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>tf_thaw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If the first guess was sea ice, but the analysis is open water, reset all nsst variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nsst</td><td>Data structure that holds the nsst fields </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ij</td><td>Index of point to be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tf_thaw</td><td>Reference temperature for former ice points </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l01666">1666</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l00926">adjust_nsst()</a>.</p>

</div>
</div>
<a id="a9ccda063fdf438966bca8efde5c6cd03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ccda063fdf438966bca8efde5c6cd03">&#9670;&nbsp;</a></span>sfc_drv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program sfc_drv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stand alone surface/NSST cycle driver for the cubed-sphere grid. </p>
<p>Each cubed-sphere tile runs independently on its own mpi task. The surface update component runs with threads. The NSST update component in not threaded.</p>
<p>There are three main options (which can be called in combination):</p><ol type="1">
<li>Update the surface fields with sfccylce (do_sfccycle = .true.)</li>
<li>Update the land states with increments read in from file (do_lndinc = .true.) Designed to work with either: 2a. A land increment file created by the GSI on the Gaussian grid. The increments are interpolated here to the model grid, using the same method as for the NST increments. This is currently implemented for applying soil temperature increments calculated from the EnKF assimilation of T2m (but this is not a requirement - any GSI-generated soil temperature increment file can be applied here). 2b. A land increment file created by JEDI, on the native model grid (cube sphere tiles). This is currently implemented for snow depth updates for the Noah model.</li>
<li>Update the NSST field, several options:</li>
</ol>
<p>3a. Update the NSST TREF field using GSI increments on the Gaussian grid. All other NSST fields are cycled. Invoke this option by setting namelist variable DONST=.true. and NST_FILE to the name of the GSI increment file.</p>
<p>3b. Run with NSST, but postpone the TREF update. Here all NSST fields are cycled. But the NSST IFD field is used to flag points that flipped from ice to open water. To invoke this option, set DONST=.true. and NST_FILE="NULL".</p>
<p>INPUT FILES:</p><ul>
<li>fngrid.$NNN The cubed-sphere grid file (contains grid point latitude and longitdue).</li>
<li>fnorog.$NNN The cubed-sphere orography file (contains land mask and orography).</li>
<li>fnbgsi.$NNN The cubed-sphere input sfc/nsst restart file.</li>
<li>$NST_FILE Gaussian GSI file which contains NSST TREF increments</li>
<li>$sfcincr_gsi.$NNN Gaussian GSI file which contains soil state increments</li>
<li>snow_xainc.$NNN The cubed-sphere snow increment file (contains increments calculated by JEDI on the native model grid).</li>
<li>soil_xainc.$NNN The cubed-sphere soil increment file (contains soil temperature and soil moisture increments calculated by JEDI on the native model grid).</li>
</ul>
<p>OUTPUT FILES:</p><ul>
<li>fnbgso.$NNN The updated sfc/nsst restart file.</li>
</ul>
<p>NOTE: $NNN corresponds to (mpi rank + 1)</p>
<p>NAMELIST VARIABLE DEFINITIONS:</p>
<ul>
<li>IDIM,JDIM i/j dimension of a cubed-sphere tile.</li>
<li>LUGB Unit number used in the sfccycle subprogram to read input datasets.</li>
<li>LSOIL Number of soil layers.</li>
<li>IY,IM,ID,IH Year, month, day, and hour of initial state.</li>
<li>FH Forecast hour</li>
<li>DELTSFC Cycling frequency in hours.</li>
<li>IALB Use modis albedo when '1'. Use brigleb when '0'.</li>
<li>USE_UFO Adjust sst and soil substrate temperature for differences between the filtered and unfiltered terrain. -DONST Process NSST records. -DO_SFCCYCLE Call sfccycle routine to update surface fields -DO_LNDINC Read in land increment files, and add increments to relevant states. NOTE: We do not have a GSI snow analysis -DO_SOI_INC_GSI Do land increments to soil states on Gaussian grids. -DO_SOI_INC_JEDI Do land increments to soil states on cubed-sphere tiles. -DO_SNO_INC_JEDI Do land increments to snow states on cubed-sphere tiles (Noah land model only). -LSOIL_INCR Number of soil layers (from top) to apply soil increments to. LSOIL_INCR is currently set to 3 by default. Extra cautions are needed on layer#3 across permafrost regions due to over sensitivity of moisture change when temperature approaches tfreez. Please feel free to contact Yuan Xue (<a href="#" onclick="location.href='mai'+'lto:'+'yua'+'n.'+'xue'+'@n'+'oaa'+'.g'+'ov'; return false;">yuan.<span style="display: none;">.nosp@m.</span>xue@<span style="display: none;">.nosp@m.</span>noaa.<span style="display: none;">.nosp@m.</span>gov</a>) for further concerns regarding this issue.</li>
<li>ISOT Use statsgo soil type when '1'. Use zobler when '0'.</li>
<li>IVEGSRC Use igbp veg type when '1'. Use sib when '2'.</li>
<li>ZSEA1/2_MM When running with NSST model, this is the lower/ upper bound of depth of sea temperature. In whole mm.</li>
<li>MAX_TASKS Normally, program should be run with a number of mpi tasks equal to the number of cubed-sphere tiles being processed. However, the current parallel scripts may over-specify the number of tasks. Set this variable to not process any ranks &gt; (max_tasks-1). -NST_FILE path/name of the gaussian GSI file which contains NSST TREF increments.</li>
</ul>
<p>-2005-02-03: Iredell for global_analysis -2014-11-30: xuli add nst_anl -2015-05-26: Hang Lei Added NEMSIO read/write function in the code -2017-08-08: Gayno Modify to work on cubed-sphere grid. Added processing of NSST and TREF update. Added mpi directives. -2020-02-17: Clara Draper Added soil state increments capability.</p>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell NOAA/EMC </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 for success, error code otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l00111">111</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">References <a class="el" href="num__parthds_8f90_source.html#l00010">num_parthds()</a>, and <a class="el" href="cycle_8f90_source.html#l00313">sfcdrv()</a>.</p>

</div>
</div>
<a id="af6a36c7ea36884692de56e4643fa16ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6a36c7ea36884692de56e4643fa16ef">&#9670;&nbsp;</a></span>sfcdrv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sfcdrv </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LUGB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>JDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LENSFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LSOIL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DELTSFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>FH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IALB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>USE_UFO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>DO_NSST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>DO_SFCCYCLE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>DO_LNDINC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>FRAC_GRID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ZSEA1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ZSEA2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ISOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IVEGSRC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MYRANK</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Driver routine for updating the surface fields. </p>
<p>This program runs in two different modes:</p>
<ol type="1">
<li><p class="startli">Analysis mode (FH=0.)</p>
<p class="startli">This program merges climatology, analysis and forecast guess to create new surface fields. If analysis file is given, the program uses it if date of the analysis matches with IY,IM,ID,IH (see Note below).</p>
</li>
<li><p class="startli">Forecast mode (FH.GT.0.)</p>
<p class="startli">This program interpolates climatology to the date corresponding to the forecast hour. If surface analysis file is given, for the corresponding dates, the program will use it. This is forcing-by-observation experiment.</p>
</li>
</ol>
<p>If the date of the analysis does not match given IY,IM,ID,IH, (and FH), the program searches an old analysis by going back 6 hours, then 12 hours, then one day upto NREPMX days (parameter statement in the SUBROTINE FIXRD. Now defined as 15). This allows the user to provide non-daily analysis to be used. If matching field is not found, the forecast guess will be used.</p>
<p>Variable naming convention for this program:</p>
<ul>
<li>OROG .. Orography</li>
<li>ALB .. Snow-free albedo</li>
<li>SWE .. Snow water equivalent</li>
<li>ZOR .. Surface roughness length</li>
<li>VET .. Vegetation type</li>
<li>TSF .. Surface skin temperature. Sea surface temp. over ocean.</li>
<li>TG3 .. Deep soil temperature (at 500cm)</li>
<li>STC .. Soil temperature (LSOIL layrs)</li>
<li>SMC .. Total soil moisture (LSOIL layrs)</li>
<li>AIS .. Sea ice mask (0 or 1)</li>
<li>CNP .. Canopy water content</li>
<li>CV .. Convective cloud cover</li>
<li>CVB .. Convective cloud base</li>
<li>CVT .. Convective cloud top</li>
<li>SLI .. LAND/SEA/SEA-ICE mask. (1/0/2 respectively)</li>
<li>VEG .. Vegetation cover</li>
<li>SOT .. Soil type</li>
<li>SIH .. Sea ice thickness</li>
<li>SIC .. Sea ice concentration</li>
<li>SND .. Snow depth</li>
<li>SLC .. Liquid soil moisture (LSOIL layers)</li>
<li>VMN .. Vegetation cover minimum</li>
<li>VMX .. Vegetation cover maximum</li>
<li>SLP .. Slope type</li>
<li>ABS .. Maximum snow albedo</li>
<li>T2M .. 2m Temperature</li>
<li>Q2M .. 2m Specific Humidity</li>
<li>TICE .. Ice Temperature</li>
<li>OROG_UF .. Orography unfiltered</li>
</ul>
<p>Most fields have a blending coefficient. This controls the blending of the forecast (first guess) and interpolated climatology or analyzed fields. When it is equal to 1.0, the pure forecast is used. When the coefficient is equal to 0, the pure climatology or analysis is used. The default values are set as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Variables  </th><th class="markdownTableHeadNone">Land  </th><th class="markdownTableHeadNone">Sea -------&mdash;   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Surface temperature  </td><td class="markdownTableBodyNone">Forecast  </td><td class="markdownTableBodyNone">Analysis   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Albedo  </td><td class="markdownTableBodyNone">Analysis  </td><td class="markdownTableBodyNone">Analysis   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Sea-ice  </td><td class="markdownTableBodyNone">Analysis  </td><td class="markdownTableBodyNone">Analysis   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Snow  </td><td class="markdownTableBodyNone">Analysis  </td><td class="markdownTableBodyNone">Forecast (over sea ice)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Roughness  </td><td class="markdownTableBodyNone">Analysis  </td><td class="markdownTableBodyNone">Forecast   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Plant resistance  </td><td class="markdownTableBodyNone">Analysis  </td><td class="markdownTableBodyNone">Analysis   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Soil moisture  </td><td class="markdownTableBodyNone">Weighted average  </td><td class="markdownTableBodyNone">Analysis   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Soil temperature  </td><td class="markdownTableBodyNone">Forecast  </td><td class="markdownTableBodyNone">Analysis   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Canopy waver content  </td><td class="markdownTableBodyNone">Forecast  </td><td class="markdownTableBodyNone">Forecast   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Convective cloud cover  </td><td class="markdownTableBodyNone">Forecast  </td><td class="markdownTableBodyNone">Forecast   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Convective cloud bottm  </td><td class="markdownTableBodyNone">Forecast  </td><td class="markdownTableBodyNone">Forecast   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Convective cloud top  </td><td class="markdownTableBodyNone">Forecast  </td><td class="markdownTableBodyNone">Forecast   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Vegetation greenness  </td><td class="markdownTableBodyNone">Analysis  </td><td class="markdownTableBodyNone">Analysis   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">Vegetation type  </td><td class="markdownTableBodyNone">Analysis  </td><td class="markdownTableBodyNone">Analysis   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Soil type  </td><td class="markdownTableBodyNone">Analysis  </td><td class="markdownTableBodyNone">Analysis   </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">LUGB</td><td>Fortran unit number uses in sfccycle subprogram to read input datasets. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IDIM</td><td>'i' dimension of the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">JDIM</td><td>'j' dimension of the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LENSFC</td><td>Total numberof points for the cubed-sphere tile </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LSOIL</td><td>Number of soil layers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DELTSFC</td><td>Cycling frequency in hours </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IY</td><td>Year of initial state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IM</td><td>Month of initial state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ID</td><td>Day of initial state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IH</td><td>Hour of initial state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">FH</td><td>Forecast hour </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IALB</td><td>Use modis albedo when '1'. Use brigleb when '0'. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">USE_UFO</td><td>When true, adjust SST and soil temperature for differences between the filtered and unfiltered terrain. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DO_NSST</td><td>When true, process NSST records. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DO_SFCCYCLE</td><td>Call sfccycle routine to update surface fields </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DO_LNDINC</td><td>Read in land increment files, and add increments to requested states. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">FRAC_GRID</td><td>When true, run with fractional grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ZSEA1</td><td>When running NSST model, this is the lower bound of depth of sea temperature. In whole mm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ZSEA2</td><td>When running NSST model, this is the upper bound of depth of sea temperature. In whole mm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ISOT</td><td>Use STATSGO soil type when '1'. Use Zobler when '0'. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IVEGSRC</td><td>Use IGBP vegetation type when '1'. Use SIB when '2'. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MYRANK</td><td>MPI rank number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell, George Gayno </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l00313">313</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">References <a class="el" href="cycle_8f90_source.html#l00926">adjust_nsst()</a>, <a class="el" href="cycle_8f90_source.html#l01829">get_sal_clm()</a>, <a class="el" href="cycle_8f90_source.html#l01712">get_tf_clm()</a>, <a class="el" href="read__write__data_8f90_source.html#l01101">read_write_data::read_data()</a>, <a class="el" href="read__write__data_8f90_source.html#l00909">read_write_data::read_gsi_data()</a>, <a class="el" href="read__write__data_8f90_source.html#l00733">read_write_data::read_lat_lon_orog()</a>, and <a class="el" href="read__write__data_8f90_source.html#l00132">read_write_data::write_data()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l00111">sfc_drv()</a>.</p>

</div>
</div>
<a id="ade32d73a7d3d2ee2e9813674aea1f797"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade32d73a7d3d2ee2e9813674aea1f797">&#9670;&nbsp;</a></span>tf_thaw_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tf_thaw_set </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nx*ny), intent(in)&#160;</td>
          <td class="paramname"><em>tf_ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nx*ny), intent(in)&#160;</td>
          <td class="paramname"><em>mask_ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jtile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>tice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>tclm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>tf_thaw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>nset_thaw_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>nset_thaw_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>nset_thaw_c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the background reference temperature (tf) for points where the ice has just melted. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tf_ij</td><td>Foundation temperature background on FV3 native grids. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mask_ij</td><td>Mask of the tile (FV3 native grids). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itile</td><td>Location index in the 'i' direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jtile</td><td>Location index in the 'j' direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tice</td><td>Water temperature (calulated with a salinity formula). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tclm</td><td>SST climatology valid at the analysis time. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tf_thaw</td><td>Foundation temperature of thawed points. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nx</td><td>'i' dimension of tf_ij </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ny</td><td>'j' dimension of tf_ij </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nset_thaw_s</td><td>Number of foundation temperature points filled via a search. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nset_thaw_i</td><td>Number of ice points filled with a calculated tice. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nset_thaw_c</td><td>Number of points filled with a weighted average of tice and tclm. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Xu Li </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l01576">1576</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="cycle_8f90_source.html#l00926">adjust_nsst()</a>.</p>

</div>
</div>
<a id="a8609bf25108d7ef0c230efe2a92d2517"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8609bf25108d7ef0c230efe2a92d2517">&#9670;&nbsp;</a></span>tfreez()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function tfreez </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>salinity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the freezing point of water as a function of salinity. </p>
<p>Constants taken from Gill, 1982.</p>
<dl class="section date"><dt>Date</dt><dd>21 September 1994. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Robert Grumbine</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">salinity</td><td>The salinity. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>tfreez The freezing point of water. </dd></dl>

<p class="definition">Definition at line <a class="el" href="cycle_8f90_source.html#l02090">2090</a> of file <a class="el" href="cycle_8f90_source.html">cycle.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d8b772108138bf796aaa3f7fe4e09294.html">sorc</a></li><li class="navelem"><a class="el" href="dir_2639f2b978b79eb67637490d5ddd2bd6.html">global_cycle.fd</a></li><li class="navelem"><a class="el" href="cycle_8f90.html">cycle.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
